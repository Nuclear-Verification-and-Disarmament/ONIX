

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>onix.utils.data_processor &mdash; ONIX Documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #0d0d0d" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pythonapi/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License Agreement</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ONIX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>onix.utils.data_processor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for onix.utils.data_processor</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">.functions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">onix.data</span> <span class="k">as</span> <span class="nn">d</span>
<span class="c1">#import pylab</span>

<span class="k">def</span> <span class="nf">read_nuclide_reac_rank</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">zamid</span> <span class="o">=</span> <span class="n">name_to_zamid</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>

    <span class="n">search</span> <span class="o">=</span> <span class="s1">&#39;nuclide&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="s1">&#39; ===</span><span class="si">{}</span><span class="s1">(</span><span class="si">{}</span><span class="s1">) ===</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">zamid</span><span class="p">):</span>
            <span class="n">search</span> <span class="o">=</span> <span class="s1">&#39;step&#39;</span>
        <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="s1">&#39;STEP </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="ow">and</span> <span class="n">search</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


    <span class="n">destruction</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">dest_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">dest_total</span> <span class="o">+=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">destruction</span><span class="p">[</span><span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">dest_total</span><span class="p">]</span> <span class="c1"># val and percent</span>


    <span class="n">production</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">prod_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">reaction_val</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">reaction_val</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>    
            <span class="n">prod_total</span> <span class="o">+=</span> <span class="n">reaction_val</span>

    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">reaction_val</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">reaction_val</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>    
            <span class="n">production</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">reaction</span><span class="p">,</span> <span class="n">reaction_val</span><span class="p">,</span> <span class="n">reaction_val</span><span class="o">/</span><span class="n">prod_total</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">destruction</span><span class="p">,</span> <span class="n">production</span><span class="p">]</span>

<div class="viewcode-block" id="plot_bucell_nuclide_network"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_bucell_nuclide_network.html#onix.utils.plot_bucell_nuclide_network">[docs]</a><span class="k">def</span> <span class="nf">plot_bucell_nuclide_network</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Plots a network diagram of the destruction and production reaction rates of a specified nuclide at a given macrostep for a given BUCell. Reaction rates are in :math:`barn^{-2}cm^{-1}s^{-1}`. Production channels are indicated with the name of the parent nuclide, destruction channels are indicated with the name of the reaction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    step: int</span>
<span class="sd">        Macrostep for which the diagram should be plotted</span>
<span class="sd">    path: str</span>
<span class="sd">        Path of the simulation directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell for which the diagram should be plotted</span>
<span class="sd">    threshold: float</span>
<span class="sd">        Value under which reaction rates are not shown on diagram</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path_to_rank</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/cell_</span><span class="si">{}</span><span class="s1">_reacs_rank&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_rank</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">zamid</span> <span class="o">=</span> <span class="n">name_to_zamid</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>

    <span class="nb">print</span> <span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">zamid</span><span class="p">)</span>
    <span class="n">search</span> <span class="o">=</span> <span class="s1">&#39;nuclide&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="s1">&#39; ===</span><span class="si">{}</span><span class="s1">(</span><span class="si">{}</span><span class="s1">) ===</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">zamid</span><span class="p">):</span>
            <span class="n">search</span> <span class="o">=</span> <span class="s1">&#39;step&#39;</span>
        <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="s1">&#39;STEP </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="ow">and</span> <span class="n">search</span> <span class="o">==</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


    <span class="n">destruction</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">dest_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="c1"># if tuples[1] == 0.0:</span>
            <span class="c1">#   continue</span>
            <span class="k">if</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">dest_total</span> <span class="o">+=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="c1"># if tuples[1] == 0.0:</span>
            <span class="c1">#   continue</span>
            <span class="k">if</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">destruction</span><span class="p">[</span><span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">dest_total</span><span class="p">]</span> <span class="c1"># val and percent</span>


    <span class="n">production</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">prod_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">reaction_val</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># if reaction_val == 0.0:</span>
            <span class="c1">#   continue    </span>
            <span class="k">if</span> <span class="n">reaction_val</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">continue</span>    
            <span class="n">prod_total</span> <span class="o">+=</span> <span class="n">reaction_val</span>

    <span class="k">for</span> <span class="n">tuples</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">reaction_val</span> <span class="o">=</span> <span class="n">tuples</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># if reaction_val == 0.0:</span>
            <span class="c1">#   continue    </span>
            <span class="k">if</span> <span class="n">reaction_val</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">production</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">reaction</span><span class="p">,</span> <span class="n">reaction_val</span><span class="p">,</span> <span class="n">reaction_val</span><span class="o">/</span><span class="n">prod_total</span><span class="p">]</span>


    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">production</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="se">\n</span><span class="si">{:.2E}</span><span class="s1">[</span><span class="si">{:.2%}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">production</span><span class="p">[</span><span class="n">parent</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">production</span><span class="p">[</span><span class="n">parent</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">production</span><span class="p">[</span><span class="n">parent</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">destruction</span><span class="p">:</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">edge</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2E}</span><span class="s1">[</span><span class="si">{:.2%}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">destruction</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">destruction</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="p">),</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Get target nuclide index</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">nuclide</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="n">edges</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">edge_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">edge_labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">([((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,),</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
                     <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
    <span class="n">node_color</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">nuclide</span><span class="p">:</span>
            <span class="n">node_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;mediumaquamarine&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">production</span><span class="p">:</span>
            <span class="n">node_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lightskyblue&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">destruction</span><span class="p">:</span>
            <span class="n">node_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;darksalmon&#39;</span><span class="p">)</span>

    <span class="n">edges</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="c1"># edge_weights = [G[u][v][&#39;weight&#39;] for u,v in edges]</span>
    <span class="c1"># red_edges = [(&#39;C&#39;,&#39;D&#39;),(&#39;D&#39;,&#39;A&#39;)]</span>
    <span class="c1"># edge_colors = [&#39;black&#39; if not edge in red_edges else &#39;red&#39; for edge in G.edges()]</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">circular_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">pos</span><span class="p">[</span><span class="n">nuclide</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">pos</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">edges</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span> <span class="n">node_color</span> <span class="o">=</span> <span class="n">node_color</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<span class="k">def</span> <span class="nf">plot_nuclide_dens_from_passport</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots the density evolution of a given nuclide (in :math:`atm barn^{-2}cm{-1}`) in a given BUCell against time (in days). This method requires that the corresonding Passport and BUCell objects are already defined in the Python environment.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: onix.Cell</span>
<span class="sd">    nuclide: onix.Passport</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="n">bucell</span><span class="o">.</span><span class="n">sequence</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">sequence</span><span class="o">.</span><span class="n">time_seq</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dens_seq</span> <span class="o">=</span> <span class="n">nuclide</span><span class="o">.</span><span class="n">dens_seq</span> 

    <span class="n">time_seq</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">time_seq</span><span class="p">]</span><span class="c1"># time_seq is in seconds</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">dens_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density [atm/cm3]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> density evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">nuclide</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_nuclide_dens</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">):</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">dens_seq</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">dens_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density [atm/cm3]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> density evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<div class="viewcode-block" id="plot_nuclide_dens_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_nuclide_dens_from_path.html#onix.utils.plot_nuclide_dens_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_nuclide_dens_from_path</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">path_to_simulation</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the density evolution of a given nuclide (in :math:`atm barn^{-2}cm{-1}`) in a given BUCell against time (in days).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    path_to_simulation: str</span>
<span class="sd">        Path to simulation directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path_to_simulation</span> <span class="o">+</span> <span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">dens_seq</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">dens_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density [atm/cm3]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> density evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_nuclide_group_dens_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_nuclide_group_dens_from_path.html#onix.utils.plot_nuclide_group_dens_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_nuclide_group_dens_from_path</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide_list</span><span class="p">,</span> <span class="n">path_to_simulation</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the total density evolution of a group of nuclides (in :math:`atm barn^{-2}cm{-1}`) in a given BUCell against time (in days).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    nuclide_list: str</span>
<span class="sd">        List of the names of the nuclides</span>
<span class="sd">    path_to_simulation: str</span>
<span class="sd">        Path to simulation directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path_to_simulation</span> <span class="o">+</span> <span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">group_dens_seq</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">time_seq</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">nuclide_list</span><span class="p">:</span>
        <span class="n">dens_seq</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_dens_seq</span><span class="p">)):</span>
            <span class="n">group_dens_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_dens_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">dens_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">group_dens_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density [atm/cm3]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> density evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide_list</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">plot_xs_time_evolution</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">):</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
    <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">xs_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time in Days&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eff. XS in barn&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> effective cross sections evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_xs_bu_evolution</span><span class="p">(</span><span class="n">bucell_list</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">):</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bucell</span> <span class="ow">in</span> <span class="n">bucell_list</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

        <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

        <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bu_seq</span><span class="p">,</span> <span class="n">xs_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">bucell</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">bu_seq</span> <span class="o">=</span> <span class="n">read_bu_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;BU in MWd/kg&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eff. XS in barn&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> effective cross sections evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<div class="viewcode-block" id="plot_xs_time_evolution_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_xs_time_evolution_from_path.html#onix.utils.plot_xs_time_evolution_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_xs_time_evolution_from_path</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the one-group cross section evolution (in barn) of a given reaction for a given nuclide in a given BUCell against time (in days).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    nuclide_list: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    xs_name: str</span>
<span class="sd">        Name of the reaction</span>
<span class="sd">    path_to_simulation: str</span>
<span class="sd">        Path to simulation directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">()</span>
    <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
    <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">xs_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time in days&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eff. XS in barn&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> effective cross sections evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_xs_bu_evolution_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_xs_bu_evolution_from_path.html#onix.utils.plot_xs_bu_evolution_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_xs_bu_evolution_from_path</span><span class="p">(</span><span class="n">bucell_list</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the one-group cross section evolution (in barn) of a given reaction for a given nuclide in a given BUCell against burnup (MWd/kg).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    nuclide_list: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    xs_name: str</span>
<span class="sd">        Name of the reaction</span>
<span class="sd">    path_to_simulation: str</span>
<span class="sd">        Path to simulation directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bucell</span> <span class="ow">in</span> <span class="n">bucell_list</span><span class="p">:</span>
        <span class="n">path_xs</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

        <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">bucell</span><span class="p">)</span>

        <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bu_seq</span> <span class="o">=</span> <span class="n">read_bu_seq</span><span class="p">(</span><span class="n">path_xs</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bu_seq</span><span class="p">,</span> <span class="n">xs_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">bucell</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;BU in MWd/kg&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eff. XS in barn&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> effective cross sections evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<span class="c1"># Compare xs evolution for the same nuclide, for various xs for different runs</span>
<div class="viewcode-block" id="compare_xs_bu_evolution_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.compare_xs_bu_evolution_from_path.html#onix.utils.compare_xs_bu_evolution_from_path">[docs]</a><span class="k">def</span> <span class="nf">compare_xs_bu_evolution_from_path</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name_list</span><span class="p">,</span> <span class="n">path_list</span><span class="p">,</span> <span class="n">name_list</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots multiple cross sections from multiple simulation directories in a series of subplots with the same burnup y-axis. Evolution of the same cross section for different simulations are plotted in the same subplots.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    xs_name_list: List</span>
<span class="sd">        List of the names of the cross sections</span>
<span class="sd">    path_list: List</span>
<span class="sd">        List of the path to the different simulations&#39; directories</span>
<span class="sd">    name_list:</span>
<span class="sd">        List of the names of the different simulations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bu_seq_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xs_seq_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">path_list</span><span class="p">:</span>

        <span class="n">bu_seq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">read_bu_seq</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="n">xs_seq_list</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">xs_name_list</span><span class="p">:</span>
            <span class="n">xs_seq_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">path</span><span class="p">))</span>


    <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
    <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
    
    <span class="c1"># plt.figure(1)</span>

    <span class="c1"># for i in range(len(path_list)):</span>

    <span class="c1">#   for j in range(len(xs_name_list)):</span>

    <span class="c1">#       plt.plot(bu_seq_list[i], xs_seq_list[i][j], label = &#39;{} {}&#39;.format(name_list[i], xs_name_list[j]))</span>

    <span class="c1"># Three subplots sharing both x/y axes</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">ax_tuple</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_name_list</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> effective cross sections evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name_list</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_name_list</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path_list</span><span class="p">)):</span>
            <span class="n">ax_tuple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bu_seq_list</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">xs_seq_list</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">name_list</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">ax_tuple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Eff. XS [barn]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xs_name_list</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">ax_tuple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">ax_tuple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;BU [MWd/kg]&#39;</span><span class="p">)</span>
    <span class="c1"># Fine-tune figure; make subplots close to each other and hide x ticks for</span>
    <span class="c1"># all but bottom plot.</span>
    <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">axes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_kinf_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_kinf_from_path.html#onix.utils.plot_kinf_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_kinf_from_path</span><span class="p">(</span><span class="n">path_to_simulation</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the multiplication factor against time (in days).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path_to_simulation: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path_to_simulation</span> <span class="o">+</span> <span class="s1">&#39;/output_summary/kinf&#39;</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">kinf_seq</span> <span class="o">=</span> <span class="n">read_kinf_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">kinf_seq</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;kinf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;kinf evolution&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  </div>

<span class="k">def</span> <span class="nf">plot_flux</span><span class="p">(</span><span class="n">bucell</span><span class="p">):</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">flux_seq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">flux_seq</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux [neutron/cm3.s-1]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> neutron flux evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<div class="viewcode-block" id="plot_flux_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_flux_from_path.html#onix.utils.plot_flux_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_flux_from_path</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">path_to_simulation</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the neutron flux against time (in days).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    path_to_simulation: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path_to_simulation</span> <span class="o">+</span> <span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">flux_seq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">flux_seq</span><span class="p">,</span> <span class="n">where</span> <span class="o">=</span> <span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux [neutron/cm3.s-1]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> neutron flux evolution&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_flux_spectrum_bu_evolution_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_flux_spectrum_bu_evolution_from_path.html#onix.utils.plot_flux_spectrum_bu_evolution_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_flux_spectrum_bu_evolution_from_path</span><span class="p">(</span><span class="n">bucell_list</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the neutron spectrum for different macrosteps for multiple BUCells. Each plot represents the spectrum evolution in one BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell_list: List</span>
<span class="sd">        List of the names of the BUCells</span>
<span class="sd">    steps_list: sList</span>
<span class="sd">        List of the macrosteps for which neutron spectrum should be plotted</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bucell_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bucell</span> <span class="ow">in</span> <span class="n">bucell_list</span><span class="p">:</span>
        <span class="n">path_flux_spectrum</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_flux_spectrum&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

        <span class="n">flux_spectrum_list</span> <span class="o">=</span> <span class="n">read_flux_spectrum</span><span class="p">(</span><span class="n">path_flux_spectrum</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">)</span>

        <span class="n">energy_mid_points</span> <span class="o">=</span> <span class="n">read_energy_mid_points</span><span class="p">(</span><span class="n">path_flux_spectrum</span><span class="p">)</span>

        <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bucell_index</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">flux_spectrum</span> <span class="ow">in</span> <span class="n">flux_spectrum_list</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_mid_points</span><span class="p">,</span> <span class="n">flux_spectrum</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">steps_list</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>


        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;eV&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Neutron spectrum&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;neutron spectrum in cell </span><span class="si">{}</span><span class="s1"> for steps </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">))</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_lethargy_spectrum_bu_evolution_from_path"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_lethargy_spectrum_bu_evolution_from_path.html#onix.utils.plot_lethargy_spectrum_bu_evolution_from_path">[docs]</a><span class="k">def</span> <span class="nf">plot_lethargy_spectrum_bu_evolution_from_path</span><span class="p">(</span><span class="n">bucell_list</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the neutron spectrum in lethargy units for different macrosteps for multiple BUCells. Each plot represents the spectrum evolution in one BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell_list: List</span>
<span class="sd">        List of the names of the BUCells</span>
<span class="sd">    steps_list: List</span>
<span class="sd">        List of the macrosteps for which neutron spectrum should be plotted</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bucell_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bucell</span> <span class="ow">in</span> <span class="n">bucell_list</span><span class="p">:</span>
        <span class="n">path_flux_spectrum</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_flux_spectrum&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

        <span class="n">flux_spectrum_list</span> <span class="o">=</span> <span class="n">read_flux_spectrum</span><span class="p">(</span><span class="n">path_flux_spectrum</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">)</span>

        <span class="n">energy_mid_points</span> <span class="o">=</span> <span class="n">read_energy_mid_points</span><span class="p">(</span><span class="n">path_flux_spectrum</span><span class="p">)</span>
        <span class="n">energy_bin_length</span> <span class="o">=</span> <span class="n">read_energy_bin_length</span><span class="p">(</span><span class="n">path_flux_spectrum</span><span class="p">)</span>

        <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
        <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bucell_index</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">flux_spectrum</span> <span class="ow">in</span> <span class="n">flux_spectrum_list</span><span class="p">:</span>
            <span class="n">lethargy_spectrum</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="n">z</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flux_spectrum</span><span class="p">,</span> <span class="n">energy_mid_points</span><span class="p">,</span> <span class="n">energy_bin_length</span><span class="p">)]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_mid_points</span><span class="p">,</span> <span class="n">lethargy_spectrum</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">color_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker_list</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">steps_list</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>


        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;eV&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Neutron spectrum [lethargy unit]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;neutron spectrum in cell </span><span class="si">{}</span><span class="s1"> for steps </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">))</span>
        
        <span class="n">bucell_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_xs_dens_flux"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_xs_dens_flux.html#onix.utils.plot_xs_dens_flux">[docs]</a><span class="k">def</span> <span class="nf">plot_xs_dens_flux</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">xs_nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">dens_nuclide</span><span class="p">,</span> <span class="n">xs_path</span><span class="p">,</span> <span class="n">dens_path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots the evolution of a cross section, a nuclide density and the neutron flux in a specified BUCell in three subplots witht the same y-axis in days. This plot can be useful to understand the dynamic between the neutron flux and the absorption rates of certain nuclides.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    xs_nuclide: str</span>
<span class="sd">        Name of the nuclide for which the cross section should be plotted</span>
<span class="sd">    xs_name: str</span>
<span class="sd">        Name of the cross section to plot</span>
<span class="sd">    dens_nuclide: str</span>
<span class="sd">        Name of the nuclide for which the density should be plotted</span>
<span class="sd">    xs_path: str</span>
<span class="sd">        Path to the simulation&#39;s directory from which the cross section data should be extracted</span>
<span class="sd">    dens_path: str</span>
<span class="sd">        Path to the simulation&#39;s directory from which the nuclides density data should be extracted. The neutron flux will be taken from the same simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time_subseq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">dens_path</span><span class="p">)</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">xs_path</span><span class="p">)</span>
    <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs_seq</span><span class="p">(</span><span class="n">xs_nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">xs_path</span><span class="p">)</span>
    <span class="n">dens_subseq</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">dens_nuclide</span><span class="p">,</span> <span class="n">dens_path</span><span class="p">)</span>
    <span class="n">flux_subseq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">dens_path</span><span class="p">)</span>

    <span class="c1"># Three subplots sharing both x/y axes</span>
    <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_seq</span><span class="p">,</span> <span class="n">xs_seq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s1"> Eff. XS [barn]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xs_nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> cell&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_subseq</span><span class="p">,</span> <span class="n">dens_subseq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="se">\n</span><span class="s1">Density [atm/barn-cm]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dens_nuclide</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">time_subseq</span><span class="p">,</span> <span class="n">flux_subseq</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Neutron flux [neutron/cm2-s]&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [day]&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="c1"># Fine-tune figure; make subplots close to each other and hide x ticks for</span>
    <span class="c1"># all but bottom plot.</span>
    <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">axes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="c1"># This function reads the old format for densities</span>
<span class="c1"># Should be removed</span>
<span class="k">def</span> <span class="nf">read_time_seq_old_version</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="n">time_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">time_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="c1"># Find and store time</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TIME&#39;</span><span class="p">:</span>
                <span class="n">time_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">time_seq</span>

<div class="viewcode-block" id="read_time_seq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_time_seq.html#onix.utils.read_time_seq">[docs]</a><span class="k">def</span> <span class="nf">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the time sequence from a simulation&#39;s directory and returns a list of the time sequence.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">time_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="c1"># Find and store time</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TIME&#39;</span><span class="p">:</span>
                <span class="n">time_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">time_seq</span></div>

<div class="viewcode-block" id="get_step_time_length_seq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_step_time_length_seq.html#onix.utils.get_step_time_length_seq">[docs]</a><span class="k">def</span> <span class="nf">get_step_time_length_seq</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Creates a list with time length between each macrosteps.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">time_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">step_time_length</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">time_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">time_seq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">step_time_length</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span>  <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">time_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">time_seq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
    
    <span class="k">return</span> <span class="n">step_time_length</span></div>


<div class="viewcode-block" id="read_bu_seq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_bu_seq.html#onix.utils.read_bu_seq">[docs]</a><span class="k">def</span> <span class="nf">read_bu_seq</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the burnup sequence from a simulation&#39;s directory and returns a list of the burnup sequence.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bu_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">bu_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="c1"># Find and store time</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SYSTEM-BU&#39;</span><span class="p">:</span>
                <span class="n">bu_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">bu_seq</span></div>

<div class="viewcode-block" id="read_kinf_seq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_kinf_seq.html#onix.utils.read_kinf_seq">[docs]</a><span class="k">def</span> <span class="nf">read_kinf_seq</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the multiplication factor evolution from a simulation&#39;s directory and returns a list of the multiplication factor evolution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kinf_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">kinf_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;K-INF&#39;</span><span class="p">:</span>
                <span class="n">kinf_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">kinf_seq</span></div>


<div class="viewcode-block" id="read_flux"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_flux.html#onix.utils.read_flux">[docs]</a><span class="k">def</span> <span class="nf">read_flux</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the macrostep-wise neutron flux evolution from a simulation&#39;s directory and returns a list with the neutron flux evolution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flux_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">flux_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FLUX&#39;</span><span class="p">:</span>
                <span class="n">flux_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">break</span>
    <span class="c1"># Add an initial 0 for the flux to have same len for flux_seq and time_seq</span>
    <span class="n">flux_seq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">flux_seq</span>

    <span class="k">return</span> <span class="n">flux_seq</span></div>

<div class="viewcode-block" id="read_flux_subseq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_flux_subseq.html#onix.utils.read_flux_subseq">[docs]</a><span class="k">def</span> <span class="nf">read_flux_subseq</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the microstep-wise neutron flux evolution from a simulation&#39;s directory and returns a list with the neutron flux evolution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flux_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">flux_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FLUX&#39;</span><span class="p">:</span>
                <span class="n">flux_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">flux_seq</span></div>

<div class="viewcode-block" id="get_fluence_seq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_fluence_seq.html#onix.utils.get_fluence_seq">[docs]</a><span class="k">def</span> <span class="nf">get_fluence_seq</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Returns a list with the macrostep-wise fluence evolution in a specificed BUCell</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dens_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="n">flux_seq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">dens_file</span><span class="p">)</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">dens_file</span><span class="p">)</span>

    <span class="c1">#Reminder: flux starts with 0</span>

    <span class="n">fluence_seq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pre_time</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_seq</span><span class="p">)):</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="n">flux_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">time_int</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">-</span><span class="n">pre_time</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span>
        <span class="n">fluence_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_int</span><span class="o">*</span><span class="n">flux</span> <span class="o">+</span> <span class="n">fluence_seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">pre_time</span> <span class="o">=</span> <span class="n">time</span>

    <span class="k">return</span> <span class="n">fluence_seq</span></div>

<div class="viewcode-block" id="get_fluence_subseq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_fluence_subseq.html#onix.utils.get_fluence_subseq">[docs]</a><span class="k">def</span> <span class="nf">get_fluence_subseq</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Returns a list with the microstep-wise fluence evolution in a specificed BUCell</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">subdens_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_subdens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="n">flux_subseq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">subdens_file</span><span class="p">)</span>
    <span class="c1"># Subdens output not yet under new format</span>
    <span class="n">time_subseq</span> <span class="o">=</span> <span class="n">read_time_seq_old_version</span><span class="p">(</span><span class="n">subdens_file</span><span class="p">)</span>

    <span class="c1">#Reminder: flux starts with 0</span>

    <span class="n">fluence_subseq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pre_time</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_subseq</span><span class="p">)):</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">time_subseq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="n">flux_subseq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">time_int</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">-</span><span class="n">pre_time</span><span class="p">)</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span>
        <span class="n">fluence_subseq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_int</span><span class="o">*</span><span class="n">flux</span> <span class="o">+</span> <span class="n">fluence_subseq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">pre_time</span> <span class="o">=</span> <span class="n">time</span>

    <span class="k">return</span> <span class="n">fluence_subseq</span></div>





<div class="viewcode-block" id="read_flux_spectrum"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_flux_spectrum.html#onix.utils.read_flux_spectrum">[docs]</a><span class="k">def</span> <span class="nf">read_flux_spectrum</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">steps_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reads the neutron flux spectra for multiple macrosteps from a flux spectrum output file and returns it in a list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the neutron flux spectrum output file</span>
<span class="sd">    step_list: List</span>
<span class="sd">        List of macrostep for which spectra should be read</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flux_spectrum_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">flux_spectrum_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">flux_spectrum_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">step_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">:]:</span> <span class="c1"># The flux spectrum data always start at the 6th line</span>
        <span class="k">if</span> <span class="n">step_count</span> <span class="ow">in</span> <span class="n">steps_list</span><span class="p">:</span>
            <span class="n">flux_spectrum_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]])</span>
        <span class="n">step_count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">flux_spectrum_list</span></div>

<div class="viewcode-block" id="read_energy_mid_points"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_energy_mid_points.html#onix.utils.read_energy_mid_points">[docs]</a><span class="k">def</span> <span class="nf">read_energy_mid_points</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the mid-points of the energy groups against which the multi-group neutron flux is stored and returns it in a list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the neutron flux spectrum output file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flux_spectrum_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">flux_spectrum_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">energy_mid_points</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>

    <span class="k">return</span> <span class="n">energy_mid_points</span></div>

<div class="viewcode-block" id="read_energy_bin_length"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_energy_bin_length.html#onix.utils.read_energy_bin_length">[docs]</a><span class="k">def</span> <span class="nf">read_energy_bin_length</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Reads the energy interval of each energy bin group used to store the multi-group neutron flux and returns it in a list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the neutron flux spectrum output file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flux_spectrum_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">flux_spectrum_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">energy_bin_length</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>

    <span class="k">return</span> <span class="n">energy_bin_length</span></div>

<div class="viewcode-block" id="read_dens"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_dens.html#onix.utils.read_dens">[docs]</a><span class="k">def</span> <span class="nf">read_dens</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Reads the density (in :math:`atm barn^{-2}cm^{-1}`) of a specified nuclide from the provided density file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the density file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">zamid</span> <span class="o">=</span> <span class="n">name_to_zamid</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>

    <span class="n">dens_seq</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">dens_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">zamid</span><span class="p">:</span>
                <span class="n">dens_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">dens_seq</span></div>

<span class="c1"># For simulations using old output format</span>
<span class="k">def</span> <span class="nf">read_dens_old_version</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="n">zamid</span> <span class="o">=</span> <span class="n">name_to_zamid</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>

    <span class="n">dens_seq</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">dens_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">zamid</span><span class="p">:</span>
                <span class="n">dens_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">dens_seq</span>

<span class="c1"># cumulative dens</span>
<span class="c1"># This is not correct and should be deleted</span>
<span class="k">def</span> <span class="nf">get_cum_dens</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

    <span class="n">dens_seq</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="n">cum_dens_seq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cum_dens_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">)):</span>
        <span class="n">cum_dens_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">cum_dens_seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">cum_dens_seq</span>

<span class="c1"># This is not correct and should be deleted</span>
<span class="k">def</span> <span class="nf">convert_dens_seq_to_cum_dens_seq</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">):</span>

    <span class="n">cum_dens_seq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cum_dens_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">)):</span>
        <span class="n">cum_dens_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dens_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">cum_dens_seq</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">cum_dens_seq</span>

<span class="c1"># This should be in utils.functions</span>
<span class="c1"># It has been moved to functions</span>
<span class="c1"># def get_nucl_atomic_mass(nucl):</span>

<span class="c1">#   zamid = name_to_zamid(nucl)</span>
<span class="c1">#   zaid = zamid[:-1]</span>
<span class="c1">#   if zaid in d.default_atm_mass_lib:</span>
<span class="c1">#       M = d.default_atm_mass_lib[zaid]</span>
<span class="c1">#   else:</span>
<span class="c1">#       M = int(get_zamid_a(zamid))</span>

<span class="c1">#   return M</span>

<span class="c1"># calculate total density at certain step</span>
<div class="viewcode-block" id="get_total_density"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_total_density.html#onix.utils.get_total_density">[docs]</a><span class="k">def</span> <span class="nf">get_total_density</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Returns the total density of the material (in :math:`atm barn^{-2}cm^{-1}`) in a BUCell at a given macrostep.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    step: int</span>
<span class="sd">        Macrostep number</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nucl_name_list</span> <span class="o">=</span> <span class="n">read_dens_nucl</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
    <span class="n">dens_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dens_path</span> <span class="p">)</span>

    <span class="n">total_density</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">nucl</span> <span class="ow">in</span> <span class="n">nucl_name_list</span><span class="p">:</span>
        <span class="n">dens</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">nucl</span><span class="p">,</span> <span class="n">dens_path</span><span class="p">)[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">total_density</span> <span class="o">+=</span> <span class="n">dens</span>

    <span class="k">return</span> <span class="n">total_density</span>    </div>

<span class="c1"># calculate total mass density at certain step</span>
<div class="viewcode-block" id="get_total_mass_density"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_total_mass_density.html#onix.utils.get_total_mass_density">[docs]</a><span class="k">def</span> <span class="nf">get_total_mass_density</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Returns the total mass density of the material (in :math:`g cm^{-3}`) in a BUCell at a given macrostep.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    step: int</span>
<span class="sd">        Macrostep number</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nucl_name_list</span> <span class="o">=</span> <span class="n">read_dens_nucl</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
    <span class="n">dens_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dens_path</span> <span class="p">)</span>

    <span class="n">NA</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">NA</span>

    <span class="n">total_mass_density</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">nucl</span> <span class="ow">in</span> <span class="n">nucl_name_list</span><span class="p">:</span>
        <span class="n">dens</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">nucl</span><span class="p">,</span> <span class="n">dens_path</span><span class="p">)[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">get_nucl_atomic_mass</span><span class="p">(</span><span class="n">nucl</span><span class="p">)</span>
        <span class="n">mass_density</span> <span class="o">=</span> <span class="n">dens</span><span class="o">*</span><span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="n">NA</span><span class="p">)</span>
        <span class="n">total_mass_density</span> <span class="o">+=</span> <span class="n">mass_density</span>

    <span class="k">return</span> <span class="n">total_mass_density</span></div>


<span class="c1"># cumulative plutonium production</span>
<span class="c1"># This is not correct and should be deleted</span>
<span class="k">def</span> <span class="nf">get_cum_pu_subseq_mat</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">EFPD</span><span class="p">):</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_subdens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Pu-238&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu-239&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu-240&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu-241&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu-242&#39;</span><span class="p">,</span> <span class="s1">&#39;Pu-243&#39;</span><span class="p">]</span>

    <span class="n">final_substep</span> <span class="o">=</span><span class="n">find_substep_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">EFPD</span><span class="p">)</span>
    
    <span class="n">time_subseq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">t_before</span> <span class="o">=</span> <span class="n">time_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="p">]</span>
    <span class="n">t_after</span> <span class="o">=</span> <span class="n">time_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">cum_pu_subseq_mat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
        <span class="n">dens_subseq</span> <span class="o">=</span> <span class="n">read_dens</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">dens_subseq_until_time</span> <span class="o">=</span> <span class="n">dens_subseq</span><span class="p">[:</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dens_before</span> <span class="o">=</span> <span class="n">dens_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="p">]</span>
        <span class="n">dens_after</span> <span class="o">=</span> <span class="n">dens_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pair1</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_before</span><span class="p">,</span> <span class="n">dens_before</span><span class="p">]</span>
        <span class="n">pair2</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_after</span><span class="p">,</span> <span class="n">dens_after</span><span class="p">]</span>
        <span class="n">interpolated_dens</span> <span class="o">=</span> <span class="n">interpolation_between_two_points</span><span class="p">(</span><span class="n">pair1</span><span class="p">,</span> <span class="n">pair2</span><span class="p">,</span> <span class="n">EFPD</span><span class="p">)</span>
        <span class="n">dens_subseq</span> <span class="o">=</span> <span class="n">dens_subseq_until_time</span> <span class="o">+</span> <span class="p">[</span><span class="n">interpolated_dens</span><span class="p">]</span>
        <span class="n">cum_dens_subseq</span> <span class="o">=</span> <span class="n">convert_dens_seq_to_cum_dens_seq</span><span class="p">(</span><span class="n">dens_sbuseq</span><span class="p">)</span>

        <span class="n">cum_pu_subseq_mat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cum_dens_subseq</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cum_pu_subseq_mat</span>


<span class="c1"># linear interpolation between two points</span>
<span class="c1"># This should be in utils.function</span>
<span class="c1"># # It has been moved to utils.function</span>
<span class="c1"># def interpolation_between_two_points(pair1, pair2, x):</span>

<span class="c1">#   a = (pair2[1] - pair1[1])/(pair2[0] - pair1[0])</span>
<span class="c1">#   b = (pair1[1]*pair2[0] - pair1[0]*pair2[1])/(pair2[0] - pair1[0])</span>

<span class="c1">#   y = a*x+b</span>

<span class="c1">#   return y</span>


<div class="viewcode-block" id="read_xs_seq"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_xs_seq.html#onix.utils.read_xs_seq">[docs]</a><span class="k">def</span> <span class="nf">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Reads the cross section evolution (in barn) for a specified reactions for a given nuclide in a given BUCell and returns it in a list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    xs_name: str</span>
<span class="sd">        Name of the cross section</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="n">zamid</span> <span class="o">=</span> <span class="n">name_to_zamid</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>
    <span class="n">xs_name_found</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>

    <span class="n">xs_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">xs_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="c1"># Search for the line</span>
    <span class="n">line_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">nuclide</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">line_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># First line needs to be treated differently</span>
    <span class="k">if</span> <span class="n">lines</span><span class="p">[</span><span class="n">line_index</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">xs_name</span><span class="p">:</span>
        <span class="n">xs_name_found</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
        <span class="n">xs_seq</span><span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">line_index</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]]</span>

    <span class="n">xs_loop</span> <span class="o">=</span> <span class="n">line_index</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">while</span> <span class="n">lines</span><span class="p">[</span><span class="n">xs_loop</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">zamid</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">lines</span><span class="p">[</span><span class="n">xs_loop</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">xs_name</span><span class="p">:</span>
            <span class="n">xs_name_found</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
            <span class="n">xs_seq</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">xs_loop</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]]</span>
        <span class="n">xs_loop</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">xs_name_found</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">xs_name_not_found</span><span class="p">(</span><span class="s2">&quot;nuclide </span><span class="si">{}</span><span class="s2"> has no data for cross section </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">xs_seq</span></div>

<div class="viewcode-block" id="get_time_averaged_xs"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_time_averaged_xs.html#onix.utils.get_time_averaged_xs">[docs]</a><span class="k">def</span> <span class="nf">get_time_averaged_xs</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Computes time-averaged cross section (in barn) for a specified reactions for a given nuclide in a given BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    xs_name: str</span>
<span class="sd">        Name of the cross section</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xs_lib_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">xs_lib_path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
    <span class="n">dens_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">dens_path</span><span class="p">)</span>
    <span class="n">tot_time</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">av_xs</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_seq</span><span class="p">)):</span>

        <span class="n">xs</span> <span class="o">=</span> <span class="n">xs_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">time_bos</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">time_eos</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">time_coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_eos</span> <span class="o">-</span> <span class="n">time_bos</span><span class="p">)</span><span class="o">/</span><span class="n">tot_time</span>
        <span class="n">av_xs</span> <span class="o">+=</span> <span class="n">xs</span><span class="o">*</span><span class="n">time_coeff</span>

    <span class="k">return</span> <span class="n">av_xs</span></div>

<div class="viewcode-block" id="get_time_averaged_flux"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_time_averaged_flux.html#onix.utils.get_time_averaged_flux">[docs]</a><span class="k">def</span> <span class="nf">get_time_averaged_flux</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Computes the time-averaged neutron flux (in :math:`cm^{-2}s^{-1}`) in a given BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">xs_lib_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">flux_seq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">xs_lib_path</span><span class="p">)</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">xs_lib_path</span><span class="p">)</span>
    <span class="n">tot_time</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">av_flux</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flux_seq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">flux</span> <span class="o">=</span> <span class="n">flux_seq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">time_bos</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">time_eos</span> <span class="o">=</span> <span class="n">time_seq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">time_coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">time_eos</span> <span class="o">-</span> <span class="n">time_bos</span><span class="p">)</span><span class="o">/</span><span class="n">tot_time</span>
        <span class="n">av_flux</span> <span class="o">+=</span> <span class="n">flux</span><span class="o">*</span><span class="n">time_coeff</span>

    <span class="k">return</span> <span class="n">av_flux</span></div>


<div class="viewcode-block" id="get_tot_xs"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.get_tot_xs.html#onix.utils.get_tot_xs">[docs]</a><span class="k">def</span> <span class="nf">get_tot_xs</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Computes the total one-group cross section evolution (in barn) for a specified nuclide in a given BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nuclide: str</span>
<span class="sd">        Name of the nuclide</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xs_name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fission&#39;</span><span class="p">,</span><span class="s1">&#39;(n,gamma)&#39;</span><span class="p">,</span><span class="s1">&#39;(n,2n)&#39;</span><span class="p">,</span><span class="s1">&#39;(n,3n)&#39;</span><span class="p">,</span><span class="s1">&#39;(n,p)&#39;</span><span class="p">,</span><span class="s1">&#39;(n,a)&#39;</span><span class="p">,</span><span class="s1">&#39;(n,gamma)X&#39;</span><span class="p">]</span>

    <span class="n">tot_xs_seq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">xs_name</span> <span class="ow">in</span> <span class="n">xs_name_list</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xs_seq</span> <span class="o">=</span> <span class="n">read_xs_seq</span><span class="p">(</span><span class="n">nuclide</span><span class="p">,</span> <span class="n">xs_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">xs_name_not_found</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tot_xs_seq</span> <span class="o">=</span> <span class="n">xs_seq</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tot_xs_seq</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tot_xs_seq</span><span class="p">,</span><span class="n">xs_seq</span><span class="p">)]</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">tot_xs_seq</span></div>




<span class="c1"># This method list all nuclides that are present in xs lib</span>
<div class="viewcode-block" id="read_xs_nucl"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_xs_nucl.html#onix.utils.read_xs_nucl">[docs]</a><span class="k">def</span> <span class="nf">read_xs_nucl</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">bucell</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Returns the list of nuclides for which one-group cross sections have been calculated during a simulation in a given BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>

    <span class="n">xs_lib_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">xs_lib_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">nucl_name_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">nuc_name_dic</span><span class="p">:</span>
            <span class="n">nucl_name_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">xs_lib_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


    <span class="k">return</span> <span class="n">nucl_name_list</span></div>

<span class="c1"># make a list of all nuclide present in the dens_file</span>
<div class="viewcode-block" id="read_dens_nucl"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.read_dens_nucl.html#onix.utils.read_dens_nucl">[docs]</a><span class="k">def</span> <span class="nf">read_dens_nucl</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Returns the list of nuclides for which densities have been calculated during a simulation in a given BUCell.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dens_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dens_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">dens_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">nucl_zamid_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">:]:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">nucl_zamid_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">dens_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">nucl_name_list</span> <span class="o">=</span> <span class="n">zamid_list_to_name_list</span><span class="p">(</span><span class="n">nucl_zamid_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nucl_name_list</span></div>


<div class="viewcode-block" id="rank_nuclide_per_dens"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.rank_nuclide_per_dens.html#onix.utils.rank_nuclide_per_dens">[docs]</a><span class="k">def</span> <span class="nf">rank_nuclide_per_dens</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">step_list</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print a ranking of nuclides in a BUCell according to their densities for multiple macrosteps in a text file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bucell: str</span>
<span class="sd">       Name of the BUCell</span>
<span class="sd">    step_list: List</span>
<span class="sd">       List of macrostep numbers</span>
<span class="sd">    path: str</span>
<span class="sd">       Path to the simulation&#39;s directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dens_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary&#39;</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>
    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dens_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="n">dens_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">dens_list_per_step</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>

        <span class="n">dens_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Data starts at 8th line</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">:]:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">dens_dict</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># for key, value in sorted(dens_dict.iteritems(), key=lambda (k,v): (v,k)):</span>
        <span class="c1">#     print (&quot;%s: %s&quot; % (key, value))</span>

        <span class="n">sorted_dens_dict</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dens_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dens_list_per_step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sorted_dens_dict</span><span class="p">)</span>

    <span class="n">dens_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">sorted_dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ranked dens&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:&lt;20}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dens_list_per_step</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>
            <span class="n">dens_list</span> <span class="o">=</span> <span class="n">dens_list_per_step</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:&lt;8}{:&lt;12.2E}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dens_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">dens_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 

    <span class="n">sorted_dens_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
    <span class="n">sorted_dens_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<span class="c1"># This function is broken</span>
<span class="k">def</span> <span class="nf">rank_nuclide_per_reac_rate</span><span class="p">(</span><span class="n">bucell</span><span class="p">,</span> <span class="n">step_list</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>

    <span class="n">dens_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary&#39;</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>
    <span class="n">dens_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">dens_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">xs_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary&#39;</span> <span class="o">+</span> <span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_xs_lib&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bucell</span><span class="p">)</span>
    <span class="n">xs_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">xs_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="c1"># Read densities</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">dens_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">dens_dict_per_step</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>
        <span class="n">dens_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Data starts at 8th line</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">:]:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">zamid_to_name</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">dens_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">dens_dict_per_step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dens_dict</span><span class="p">)</span>

    <span class="c1"># Read xs</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">xs_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">xs_dict_per_step</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>
        <span class="n">xs_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Data starts at 8th line</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">nuc_name_dic</span><span class="p">:</span>
                <span class="c1"># For first data, you need to read data first</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">nucl_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">abs_xs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">step</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>

                <span class="c1"># Reached new nuclide, need to store data</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xs_dict</span><span class="p">[</span><span class="n">nucl_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">abs_xs</span>
                    <span class="n">nucl_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">abs_xs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">step</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">abs_xs</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">step</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">xs_dict_per_step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xs_dict</span><span class="p">)</span>

    <span class="n">flux_per_step</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">flux_seq</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">dens_path</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>
        <span class="n">flux_per_step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flux_seq</span><span class="p">[</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># flux starts with 0</span>


    <span class="c1"># Now we will go over each nuclide in the dict per step and multiply xs with density</span>
    <span class="c1">#print (xs_dict_per_step)</span>

    <span class="n">sorted_reac_dict_per_step</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">total_abs_per_step</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_list</span><span class="p">)):</span>
        <span class="n">dens_dict</span> <span class="o">=</span> <span class="n">dens_dict_per_step</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">xs_dict</span> <span class="o">=</span> <span class="n">xs_dict_per_step</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">reac_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">nucl</span> <span class="ow">in</span> <span class="n">xs_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nucl</span> <span class="ow">in</span> <span class="n">dens_dict</span><span class="p">:</span>
                <span class="n">nucl_dens</span> <span class="o">=</span> <span class="n">dens_dict</span><span class="p">[</span><span class="n">nucl</span><span class="p">]</span>
                <span class="n">nucl_xs</span> <span class="o">=</span> <span class="n">xs_dict</span><span class="p">[</span><span class="n">nucl</span><span class="p">]</span>
                <span class="n">reac_rate</span> <span class="o">=</span> <span class="n">nucl_dens</span><span class="o">*</span><span class="n">nucl_xs</span>
                <span class="n">reac_dict</span><span class="p">[</span><span class="n">nucl</span><span class="p">]</span> <span class="o">=</span> <span class="n">reac_rate</span>

        <span class="c1"># Create a sorted list of tuples</span>
        <span class="n">sorted_reac_tuple</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">reac_dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sorted_reac_dict_per_step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sorted_reac_tuple</span><span class="p">)</span>
        <span class="n">total_abs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sorted_reac_tuple</span><span class="p">:</span>
            <span class="n">total_abs</span> <span class="o">+=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">total_abs_per_step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_abs</span><span class="p">)</span>

    <span class="n">dens_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">xs_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">sorted_reac_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ranked react&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_list</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:&lt;20}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_list</span><span class="p">)):</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;flux=</span><span class="si">{:&lt;10.5E}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">flux_per_step</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>

    <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_list</span><span class="p">)):</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;tot-abs=</span><span class="si">{:&lt;10.5E}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">total_abs_per_step</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>

    <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_reac_dict_per_step</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_list</span><span class="p">)):</span>
            <span class="n">reac_tuple_list</span> <span class="o">=</span> <span class="n">sorted_reac_dict_per_step</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:&lt;8}{:&lt;12.2E}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reac_tuple_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">reac_tuple_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 

    <span class="n">sorted_reac_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
    <span class="n">sorted_reac_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_matrix_from_compressed_matrix</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="n">path_to_xs</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/step_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_cell&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/matrix/xs_mat&#39;</span>
    <span class="n">path_to_decay</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/step_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_cell&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/matrix/decay_mat&#39;</span>
    <span class="n">file_xs</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_xs</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">file_decay</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_decay</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines_xs</span> <span class="o">=</span> <span class="n">file_xs</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">lines_decay</span> <span class="o">=</span> <span class="n">file_decay</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># x_vect = [i for i in range(len(lines))]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)):</span>
        <span class="n">line_xs</span> <span class="o">=</span> <span class="n">lines_xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">line_decay</span> <span class="o">=</span> <span class="n">lines_decay</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">zamid</span> <span class="o">=</span> <span class="n">line_xs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">line_elt_xs</span> <span class="o">=</span> <span class="n">line_xs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">elts_xs</span> <span class="o">=</span> <span class="n">line_elt_xs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Last element empty because of last coma in each line</span>
        <span class="n">current_line_xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_x_vect_xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">elt_val_xs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)</span> <span class="o">-</span> <span class="n">count</span>  <span class="c1"># The value assigned is the index of the nuclide starting from the last</span>
        <span class="k">for</span> <span class="n">elt_xs</span> <span class="ow">in</span> <span class="n">elts_xs</span><span class="p">:</span>
            <span class="n">elt_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">elt_xs</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">current_x_vect_xs</span> <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_index</span><span class="p">)</span>
            <span class="n">current_line_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_val_xs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_xs</span> <span class="p">,</span> <span class="n">current_line_xs</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;cross section&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_xs</span> <span class="p">,</span> <span class="n">current_line_xs</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">line_elt_decay</span> <span class="o">=</span> <span class="n">line_decay</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">elts_decay</span> <span class="o">=</span> <span class="n">line_elt_decay</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Last element empty because of last coma in each line</span>
        <span class="n">current_line_decay</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_x_vect_decay</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">elt_val_decay</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_decay</span><span class="p">)</span> <span class="o">-</span> <span class="n">count</span>  <span class="c1"># The value assigned is the index of the nuclide starting from the last</span>
        <span class="k">for</span> <span class="n">elt_decay</span> <span class="ow">in</span> <span class="n">elts_decay</span><span class="p">:</span>
            <span class="n">elt_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">elt_decay</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">current_x_vect_decay</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_index</span><span class="p">)</span>
            <span class="n">current_line_decay</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_val_decay</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>    
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_decay</span> <span class="p">,</span> <span class="n">current_line_decay</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_decay</span> <span class="p">,</span> <span class="n">current_line_decay</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
        <span class="c1">#mat.append(current_line)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">file_xs</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">file_decay</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<div class="viewcode-block" id="plot_matrix_bysign_from_compressed_matrix"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_matrix_bysign_from_compressed_matrix.html#onix.utils.plot_matrix_bysign_from_compressed_matrix">[docs]</a><span class="k">def</span> <span class="nf">plot_matrix_bysign_from_compressed_matrix</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots the transmuation matrix for a given BUCell at a given macrostep. Negative elements are in black while positive elements are in red.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the simulation&#39;s directory</span>
<span class="sd">    step: int</span>
<span class="sd">        Macrostep number</span>
<span class="sd">    cell: str</span>
<span class="sd">        Name of the BUCell</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="c1">#plt.style.use(&#39;dark_background&#39;)</span>
    <span class="n">path_to_xs</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/step_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_cell&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/matrix/xs_mat&#39;</span>
    <span class="n">path_to_decay</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/step_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_cell&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;/matrix/decay_mat&#39;</span>
    <span class="n">file_xs</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_xs</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">file_decay</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_decay</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">lines_xs</span> <span class="o">=</span> <span class="n">file_xs</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">lines_decay</span> <span class="o">=</span> <span class="n">file_decay</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">size</span> <span class="o">=</span> <span class="mf">0.8</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.3</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># x_vect = [i for i in range(len(lines))]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)):</span>
        <span class="n">line_xs</span> <span class="o">=</span> <span class="n">lines_xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">line_decay</span> <span class="o">=</span> <span class="n">lines_decay</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">zamid</span> <span class="o">=</span> <span class="n">line_xs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">line_elt_xs</span> <span class="o">=</span> <span class="n">line_xs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">elts_xs</span> <span class="o">=</span> <span class="n">line_elt_xs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Last element empty because of last coma in each line</span>
        <span class="n">current_line_xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_x_vect_xs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#elt_val_xs = len(lines_xs) - count  # The value assigned is the index of the nuclide starting from the last</span>
        <span class="n">elt_val_xs</span> <span class="o">=</span> <span class="n">count</span>
        <span class="k">for</span> <span class="n">elt_xs</span> <span class="ow">in</span> <span class="n">elts_xs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">elt_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">elt_xs</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">current_x_vect_xs</span> <span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_index</span><span class="p">)</span>
            <span class="n">current_line_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_val_xs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_xs</span> <span class="p">,</span> <span class="n">current_line_xs</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Production terms&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_xs</span> <span class="p">,</span> <span class="n">current_line_xs</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
        <span class="n">line_elt_decay</span> <span class="o">=</span> <span class="n">line_decay</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">elts_decay</span> <span class="o">=</span> <span class="n">line_elt_decay</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Last element empty because of last coma in each line</span>
        <span class="n">current_line_decay</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_x_vect_decay</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#elt_val_decay = len(lines_decay) - count  # The value assigned is the index of the nuclide starting from the last</span>
        <span class="n">elt_val_decay</span> <span class="o">=</span> <span class="n">count</span>
        <span class="k">for</span> <span class="n">elt_decay</span> <span class="ow">in</span> <span class="n">elts_decay</span><span class="p">:</span>
            <span class="n">elt_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">elt_decay</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">current_x_vect_decay</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_index</span><span class="p">)</span>
            <span class="n">current_line_decay</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elt_val_decay</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>    
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_decay</span> <span class="p">,</span> <span class="n">current_line_decay</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">current_x_vect_decay</span> <span class="p">,</span> <span class="n">current_line_decay</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
        <span class="c1">#mat.append(current_line)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># cover diag elt</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines_xs</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Destruction terms&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span>  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">file_xs</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">file_decay</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Row index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Column index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">},</span> <span class="n">markerscale</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;darkgray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>






<div class="viewcode-block" id="plot_nuclide_chart_color_per_nuclear_data"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_nuclide_chart_color_per_nuclear_data.html#onix.utils.plot_nuclide_chart_color_per_nuclear_data">[docs]</a><span class="k">def</span> <span class="nf">plot_nuclide_chart_color_per_nuclear_data</span><span class="p">(</span><span class="n">decay_path</span><span class="p">,</span> <span class="n">fy_path</span><span class="p">,</span> <span class="n">path_to_xs_xml</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots a chart of the nuclide where nuclides are colored only if present in the decay, cross section or fission yield library. Different colors are used to indicate that a nuclide has data in the decay, cross section or fission yield library. The </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    decay_path: str</span>
<span class="sd">        Path to a decay library</span>
<span class="sd">    fy_path: str</span>
<span class="sd">        Path to a fission yield library</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fy_dict</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">fy_path</span><span class="p">)</span>
    <span class="n">fy_unordered_keys</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict</span><span class="p">)</span>
    <span class="n">fy_nucl_list</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">fy_unordered_keys</span><span class="p">)</span>

    <span class="n">decay_dict</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_decay_lib</span><span class="p">(</span><span class="n">decay_path</span><span class="p">)</span>
    <span class="n">decay_unordered_keys</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">decay_dict</span><span class="p">)</span>
    <span class="n">decay_nucl_list</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">decay_unordered_keys</span><span class="p">)</span>

    <span class="n">MC_xs_nucl_name_list</span> <span class="o">=</span> <span class="n">get_openmc_xs_nucl_list</span><span class="p">(</span><span class="n">path_to_xs_xml</span><span class="p">)</span>
    <span class="n">xs_nucl_list_name_list</span> <span class="o">=</span> <span class="n">mc_namelist_to_bu_namelist</span><span class="p">(</span><span class="n">MC_xs_nucl_name_list</span><span class="p">)</span>
    <span class="n">xs_nucl_list</span> <span class="o">=</span> <span class="n">name_list_to_zamid_list</span><span class="p">(</span><span class="n">xs_nucl_list_name_list</span><span class="p">)</span>
    <span class="n">xs_nucl_list</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">xs_nucl_list</span><span class="p">)</span>

    <span class="n">NAX_nucl_list</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">NAX_nucl_list</span>

    <span class="n">orphan_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">orphan_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">only_decay_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_decay_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_decay_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_decay_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>   

    <span class="n">only_fy_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_fy_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_fy_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_fy_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">only_xs_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_xs_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_xs_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_xs_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">only_xs_zamid</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">decay_xs_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_xs_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_xs_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_xs_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">decay_fy_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_fy_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_fy_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_fy_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">xs_fy_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xs_fy_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xs_fy_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xs_fy_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">decay_xs_fy_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_xs_fy_n</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_xs_fy_NAX_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_xs_fy_NAX_n</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">decay_zamid</span> <span class="ow">in</span> <span class="n">decay_nucl_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">in_fy</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">fy_zamid</span> <span class="ow">in</span> <span class="n">fy_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fy_zamid</span> <span class="o">==</span> <span class="n">decay_zamid</span><span class="p">:</span>
                <span class="n">in_fy</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_xs</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">xs_zamid</span> <span class="ow">in</span> <span class="n">xs_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xs_zamid</span> <span class="o">==</span> <span class="n">decay_zamid</span><span class="p">:</span>
                <span class="n">in_xs</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_NAX</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">NAX_zamid</span> <span class="ow">in</span> <span class="n">NAX_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NAX_zamid</span> <span class="o">==</span> <span class="n">decay_zamid</span><span class="p">:</span>
                <span class="n">in_NAX</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">only_decay_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">only_decay_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">only_decay_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">only_decay_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">decay_fy_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">decay_fy_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">decay_fy_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">decay_fy_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">decay_xs_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">decay_xs_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">decay_xs_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">decay_xs_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">decay_xs_fy_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">decay_xs_fy_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">decay_xs_fy_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>
            <span class="n">decay_xs_fy_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">fy_zamid</span> <span class="ow">in</span> <span class="n">fy_nucl_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">in_xs</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">xs_zamid</span> <span class="ow">in</span> <span class="n">xs_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fy_zamid</span> <span class="o">==</span> <span class="n">xs_zamid</span><span class="p">:</span>
                <span class="n">in_xs</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_decay</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">decay_zamid</span> <span class="ow">in</span> <span class="n">decay_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fy_zamid</span> <span class="o">==</span> <span class="n">decay_zamid</span><span class="p">:</span>
                <span class="n">in_decay</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_NAX</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">NAX_zamid</span> <span class="ow">in</span> <span class="n">NAX_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fy_zamid</span> <span class="o">==</span> <span class="n">NAX_zamid</span><span class="p">:</span>
                <span class="n">in_NAX</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">only_fy_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>
            <span class="n">only_fy_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">only_fy_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>
            <span class="n">only_fy_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">xs_fy_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>
            <span class="n">xs_fy_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">xs_fy_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>
            <span class="n">xs_fy_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">fy_zamid</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">xs_zamid</span> <span class="ow">in</span> <span class="n">xs_nucl_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">xs_zamid</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">in_decay</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">decay_zamid</span> <span class="ow">in</span> <span class="n">decay_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xs_zamid</span> <span class="o">==</span> <span class="n">decay_zamid</span><span class="p">:</span>
                <span class="n">in_decay</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_fy</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">fy_zamid</span> <span class="ow">in</span> <span class="n">fy_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xs_zamid</span> <span class="o">==</span> <span class="n">fy_zamid</span><span class="p">:</span>
                <span class="n">in_fy</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_NAX</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">NAX_zamid</span> <span class="ow">in</span> <span class="n">NAX_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xs_zamid</span> <span class="o">==</span> <span class="n">NAX_zamid</span><span class="p">:</span>
                <span class="n">in_NAX</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">only_xs_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">xs_zamid</span><span class="p">))</span>
            <span class="n">only_xs_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">xs_zamid</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_NAX</span> <span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">only_xs_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">xs_zamid</span><span class="p">))</span>
            <span class="n">only_xs_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">xs_zamid</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">NAX_zamid</span> <span class="ow">in</span> <span class="n">NAX_nucl_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">NAX_zamid</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">in_decay</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">decay_zamid</span> <span class="ow">in</span> <span class="n">decay_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NAX_zamid</span> <span class="o">==</span> <span class="n">decay_zamid</span><span class="p">:</span>
                <span class="n">in_decay</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_fy</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">fy_zamid</span> <span class="ow">in</span> <span class="n">fy_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NAX_zamid</span> <span class="o">==</span> <span class="n">fy_zamid</span><span class="p">:</span>
                <span class="n">in_fy</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="n">in_xs</span> <span class="o">=</span> <span class="s1">&#39;no&#39;</span>
        <span class="k">for</span> <span class="n">xs_zamid</span> <span class="ow">in</span> <span class="n">xs_nucl_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NAX_zamid</span> <span class="o">==</span> <span class="n">xs_zamid</span><span class="p">:</span>
                <span class="n">in_xs</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">in_fy</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_decay</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span> <span class="ow">and</span> <span class="n">in_xs</span> <span class="o">==</span><span class="s1">&#39;no&#39;</span><span class="p">:</span>
            <span class="n">orphan_NAX_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">NAX_zamid</span><span class="p">))</span>
            <span class="n">orphan_NAX_n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">NAX_zamid</span><span class="p">))</span>




    <span class="c1"># for i in range(len(decay_fy_n)):</span>
    <span class="c1">#   if decay_fy_n[i] == 52 and decay_fy_z[i] ==41:</span>
    <span class="c1">#       print (i)</span>
    <span class="c1">#       print (&#39;410920 in decay_fy&#39;)</span>

    <span class="c1"># for i in range(len(decay_xs_fy_NAX_n)):</span>
    <span class="c1">#   if decay_xs_fy_NAX_n[i] == 52 and decay_xs_fy_NAX_z[i] ==41:</span>
    <span class="c1">#       print (i)</span>
    <span class="c1">#       print (&#39;410920 in decay_xs_fy_NAX&#39;)</span>


    <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span>

    <span class="c1"># setup the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">only_decay_n</span><span class="p">,</span> <span class="n">only_decay_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay only&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">only_decay_NAX_n</span><span class="p">,</span> <span class="n">only_decay_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay only NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">only_xs_n</span><span class="p">,</span> <span class="n">only_xs_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;xs only&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">only_xs_NAX_n</span><span class="p">,</span> <span class="n">only_xs_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;xs only NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">only_fy_n</span><span class="p">,</span> <span class="n">only_fy_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;fy only&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">only_fy_NAX_n</span><span class="p">,</span> <span class="n">only_fy_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;fy only NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_fy_n</span><span class="p">,</span> <span class="n">decay_fy_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay &amp; fy&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_fy_NAX_n</span><span class="p">,</span> <span class="n">decay_fy_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay &amp; fy NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_xs_n</span><span class="p">,</span> <span class="n">decay_xs_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay &amp; xs&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_xs_NAX_n</span><span class="p">,</span> <span class="n">decay_xs_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay &amp; xs NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs_fy_n</span><span class="p">,</span> <span class="n">xs_fy_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;xs &amp; fy&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs_fy_NAX_n</span><span class="p">,</span> <span class="n">xs_fy_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;fuchsia&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;xs &amp; fy NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_xs_fy_n</span><span class="p">,</span> <span class="n">decay_xs_fy_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay xs fy&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_xs_fy_NAX_n</span><span class="p">,</span> <span class="n">decay_xs_fy_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;decay xs fy NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">orphan_NAX_n</span><span class="p">,</span> <span class="n">orphan_NAX_z</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;orphan NAX&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Nuclide colored per data availability</span><span class="se">\n</span><span class="s1">NAX nuclides included&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
    <span class="c1"># plt.grid(&#39;on&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="c1">#plt.set_minor_frequency(2)</span>

    <span class="c1"># for i, txt in enumerate(label_list):</span>
    <span class="c1">#   plt.annotate(txt, (a_list1[i], z_list1[i]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="plot_compare_two_nuclear_data_on_nuclide_chart"><a class="viewcode-back" href="../../../pythonapi/generated/onix.utils.plot_compare_two_nuclear_data_on_nuclide_chart.html#onix.utils.plot_compare_two_nuclear_data_on_nuclide_chart">[docs]</a><span class="k">def</span> <span class="nf">plot_compare_two_nuclear_data_on_nuclide_chart</span><span class="p">(</span><span class="n">decay_path1</span><span class="p">,</span> <span class="n">fy_path1</span><span class="p">,</span><span class="n">decay_path2</span><span class="p">,</span> <span class="n">fy_path2</span><span class="p">,</span> <span class="n">path_to_xs_xml</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Plots a chart of the nuclide where nuclides are colored only if present in the decay, cross section or fission yield library. Black color indicates that the nuclide has data in decay_path1 or fy_path1. Red color indicates that nuclide has data in decay_path2 or fy_path2 (or both in libraries 1 and 2).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    decay_path1: str</span>
<span class="sd">        Path to decay library 1</span>
<span class="sd">    fy_path1: str</span>
<span class="sd">        Path to fission yield library 1</span>
<span class="sd">    decay_path2: str</span>
<span class="sd">        Path to decay library 2</span>
<span class="sd">    fy_path2: str</span>
<span class="sd">        Path to fission yield library 2</span>
<span class="sd">    path_to_xs_xml: str</span>
<span class="sd">        Path to the cross_sections.xml file in a cross section library</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fy_dict1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">fy_path1</span><span class="p">)</span>
    <span class="n">fy_unordered_keys1</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict1</span><span class="p">)</span>
    <span class="n">fy_nucl_list1</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">fy_unordered_keys1</span><span class="p">)</span>

    <span class="n">decay_dict1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_decay_lib</span><span class="p">(</span><span class="n">decay_path1</span><span class="p">)</span>
    <span class="n">decay_unordered_keys1</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">decay_dict1</span><span class="p">)</span>
    <span class="n">decay_nucl_list1</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">decay_unordered_keys1</span><span class="p">)</span>

    <span class="n">fy_dict2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">fy_path2</span><span class="p">)</span>
    <span class="n">fy_unordered_keys2</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict2</span><span class="p">)</span>
    <span class="n">fy_nucl_list2</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">fy_unordered_keys2</span><span class="p">)</span>

    <span class="n">decay_dict2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_decay_lib</span><span class="p">(</span><span class="n">decay_path2</span><span class="p">)</span>
    <span class="n">decay_unordered_keys2</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">decay_dict2</span><span class="p">)</span>
    <span class="n">decay_nucl_list2</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">decay_unordered_keys2</span><span class="p">)</span>

    <span class="n">MC_xs_nucl_name_list</span> <span class="o">=</span> <span class="n">get_openmc_xs_nucl_list</span><span class="p">(</span><span class="n">path_to_xs_xml</span><span class="p">)</span>
    <span class="n">xs_nucl_list_name_list</span> <span class="o">=</span> <span class="n">mc_namelist_to_bu_namelist</span><span class="p">(</span><span class="n">MC_xs_nucl_name_list</span><span class="p">)</span>
    <span class="n">xs_nucl_list</span> <span class="o">=</span> <span class="n">name_list_to_zamid_list</span><span class="p">(</span><span class="n">xs_nucl_list_name_list</span><span class="p">)</span>
    <span class="n">xs_nucl_list</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">xs_nucl_list</span><span class="p">)</span>

    <span class="n">NAX_nucl_list</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">NAX_nucl_list</span>

    <span class="n">decay_z1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_n1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_z1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_n1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_z2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decay_n2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_z2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_n2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xs_z2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">xs_n2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">NAX_z2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">NAX_n2</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">decay_zamid1</span> <span class="ow">in</span> <span class="n">decay_nucl_list1</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">decay_zamid1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">decay_z1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid1</span><span class="p">))</span>
        <span class="n">decay_n1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid1</span><span class="p">))</span>


    <span class="k">for</span> <span class="n">fy_zamid1</span> <span class="ow">in</span> <span class="n">fy_nucl_list1</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">fy_zamid1</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">fy_z1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">fy_zamid1</span><span class="p">))</span>
        <span class="n">fy_n1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">fy_zamid1</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">decay_zamid2</span> <span class="ow">in</span> <span class="n">decay_nucl_list2</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">decay_zamid2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">decay_z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">decay_zamid2</span><span class="p">))</span>
        <span class="n">decay_n2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">decay_zamid2</span><span class="p">))</span>


    <span class="k">for</span> <span class="n">fy_zamid2</span> <span class="ow">in</span> <span class="n">fy_nucl_list2</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">fy_zamid2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">fy_z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">fy_zamid2</span><span class="p">))</span>
        <span class="n">fy_n2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">fy_zamid2</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">xs_zamid2</span> <span class="ow">in</span> <span class="n">xs_nucl_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">xs_zamid2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">xs_z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">xs_zamid2</span><span class="p">))</span>
        <span class="n">xs_n2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">xs_zamid2</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">NAX_zamid2</span> <span class="ow">in</span> <span class="n">NAX_nucl_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">get_zamid_s</span><span class="p">(</span><span class="n">NAX_zamid2</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">NAX_z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_z</span><span class="p">(</span><span class="n">NAX_zamid2</span><span class="p">))</span>
        <span class="n">NAX_n2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_zamid_n</span><span class="p">(</span><span class="n">NAX_zamid2</span><span class="p">))</span>



    <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span>

    <span class="c1"># setup the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.3</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>

    <span class="c1"># Plot nuclear data 1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_n1</span><span class="p">,</span> <span class="n">decay_z1</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fy_n1</span><span class="p">,</span> <span class="n">fy_z1</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs_n2</span><span class="p">,</span> <span class="n">xs_z2</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="c1">#plt.scatter(NAX_n2, NAX_z2, marker = &#39;s&#39;, color=&#39;k&#39;, s = size)</span>

    <span class="c1"># Plot nuclear data 2   </span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">decay_n2</span><span class="p">,</span> <span class="n">decay_z2</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Reduced&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fy_n2</span><span class="p">,</span> <span class="n">fy_z2</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs_n2</span><span class="p">,</span> <span class="n">xs_z2</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
    <span class="c1">#plt.scatter(NAX_n2, NAX_z2, marker = &#39;s&#39;, color=&#39;b&#39;, s = size, label = &#39;Archaeology&#39;)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of neutrons&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of protons&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c1"># plt.grid(&#39;on&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
    <span class="c1">#plt.set_minor_frequency(2)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.21</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.110</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>

    <span class="c1"># for i, txt in enumerate(label_list):</span>
    <span class="c1">#   plt.annotate(txt, (a_list1[i], z_list1[i]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">plot_nuclide_chart_compare_fy</span><span class="p">(</span><span class="n">lib1_path</span><span class="p">,</span> <span class="n">lib2_path</span><span class="p">,</span> <span class="n">fissile_parent</span><span class="p">):</span>

    <span class="n">fy_dict1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">lib1_path</span><span class="p">)</span>
    <span class="n">fy_dict2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">lib2_path</span><span class="p">)</span>

    <span class="n">unordered_keys1</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict1</span><span class="p">)</span>
    <span class="n">unordered_keys2</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict2</span><span class="p">)</span>

    <span class="n">ordered_keys1</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">unordered_keys1</span><span class="p">)</span>
    <span class="n">ordered_keys2</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">unordered_keys2</span><span class="p">)</span>

    <span class="n">rel_diff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">label_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nucl_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_list2</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># sum over fy in list 1</span>
    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="n">fy_1</span> <span class="o">=</span> <span class="n">fy_dict1</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fy_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fy_1</span><span class="p">)</span>

    <span class="c1"># sum over fy in list 2</span>
    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
        <span class="n">fy_2</span> <span class="o">=</span> <span class="n">fy_dict2</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fy_list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fy_2</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">fy_1</span> <span class="o">=</span> <span class="n">fy_dict1</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fy_2</span> <span class="o">=</span> <span class="n">fy_dict2</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">fy_1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy_2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;both = 0&#39;</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">fy_1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy_2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if fy1 = 0 but fy2 != 1, set label to 100%. The inverse situation yield - 100%</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;ori = 0&#39;</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">fy_1</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy_2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if fy1 = 0 but fy2 != 1, set label to 100%. The inverse situation yield - 100%</span>
                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;jef33 = 0&#39;</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">fy_2</span> <span class="o">-</span> <span class="n">fy_1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">fy_1</span>

                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rel_diff_val</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">:</span>
                    <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">rel_diff_val</span><span class="p">)</span><span class="o">/</span><span class="n">rel_diff_val</span> <span class="c1"># set value to 500 or -500</span>

                <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:4.2E}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">fy_2</span> <span class="o">-</span> <span class="n">fy_1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">fy_1</span><span class="p">)</span>

            <span class="c1"># if rel_diff_val == 0:</span>
            <span class="c1">#   rel_diff_log.append(abs(rel_diff_val))</span>
            <span class="c1">#   rel_diff.append(rel_diff_val)</span>
            <span class="c1"># else:</span>
            <span class="n">rel_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_diff_val</span><span class="p">)</span>
            <span class="n">label_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

            <span class="n">nucl_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>



    <span class="n">not_in_jeff33_zamid</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">not_in_jeff33_zamid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>

    <span class="n">not_in_endf4_zamid</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
            <span class="n">not_in_endf4_zamid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>

    <span class="c1"># test if not_in list overlap</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">nuclide</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_endf4_zamid</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_jeff33_zamid</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">zamid</span><span class="p">)</span>


    <span class="c1"># loop over the z</span>
    <span class="c1"># z list for lib 1</span>
    <span class="n">z_list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">get_zamid_z</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
            <span class="n">z_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>


    <span class="c1"># loop over the z for the nuclide in endf4 but not jeff33</span>
    <span class="n">not_in_jeff33_z_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_jeff33_zamid</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">get_zamid_z</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="n">not_in_jeff33_z_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="c1"># loop over the z for the nuclide in jeff33 but not endf4</span>
    <span class="n">not_in_endf4_z_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_endf4_zamid</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">get_zamid_z</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="n">not_in_endf4_z_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

    <span class="c1"># # z list for lib 2</span>
    <span class="c1"># z_list2 = []</span>
    <span class="c1"># for zamid in ordered_keys2:</span>
    <span class="c1">#   z = get_zamid_z(zamid)</span>
    <span class="c1">#   z_list2.append(z)</span>

    <span class="c1"># loop over the a</span>
    <span class="c1"># a list for lib 1</span>
    <span class="n">a_list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">get_zamid_a</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
            <span class="n">a_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># loop over the a for the nuclide in endf4 but not jeff33</span>
    <span class="n">not_in_jeff33_a_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_jeff33_zamid</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">get_zamid_a</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="n">not_in_jeff33_a_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># loop over the z for the nuclide in jeff33 but not endf4</span>
    <span class="n">not_in_endf4_a_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_endf4_zamid</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">get_zamid_a</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="n">not_in_endf4_a_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c1"># loop over the n</span>
    <span class="c1"># a list for lib 1</span>
    <span class="n">n_list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">get_zamid_n</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
            <span class="n">n_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># loop over the n for the nuclide in endf4 but not jeff33</span>
    <span class="n">not_in_jeff33_n_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_jeff33_zamid</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">get_zamid_n</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="n">not_in_jeff33_n_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># loop over the n for the nuclide in jeff33 but not endf4</span>
    <span class="n">not_in_endf4_n_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zamid</span> <span class="ow">in</span> <span class="n">not_in_endf4_zamid</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">get_zamid_n</span><span class="p">(</span><span class="n">zamid</span><span class="p">)</span>
        <span class="n">not_in_endf4_n_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>


    <span class="c1"># check if list overlap</span>

    <span class="c1"># # z list for lib 2</span>
    <span class="c1"># a_list2 = []</span>
    <span class="c1"># for zamid in ordered_keys2:</span>
    <span class="c1">#   a = get_zamid_a(zamid)</span>
    <span class="c1">#   a_list2.append(a)</span>


    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">)</span> <span class="c1"># Number of labels</span>

    <span class="c1"># setup the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">tag</span> <span class="o">=</span> <span class="n">rel_diff</span><span class="c1"># Tag each point with a corresponding label    </span>

    <span class="c1"># define the colormap</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Spectral</span>
    <span class="c1"># extract all colors from the .jet map</span>
    <span class="c1"># cmaplist = [cmap(i) for i in range(cmap.N)]</span>
    <span class="c1"># # create the new map</span>
    <span class="c1"># cmap = cmap.from_list(&#39;Custom cmap&#39;, cmaplist, cmap.N)     </span>

    <span class="c1"># define the bins and normalize</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">#norm = mpl.colors.BoundaryNorm(bounds, cmap.N)</span>

    <span class="c1"># make the scatter</span>
    <span class="n">scat_a_z</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">n_list1</span><span class="p">,</span><span class="n">z_list1</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">z_list1</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="n">MidpointNormalize</span><span class="p">(</span><span class="n">midpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">100</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">)))</span>
    <span class="c1">#scat_a_z = plt.scatter(a_list1,z_list1,c=tag,cmap=cmap, marker=&#39;s&#39;, s = [20]*len(z_list1), norm=MidpointNormalize(midpoint=0,vmin=-100, vmax=max(rel_diff)))</span>
    
    <span class="n">scat2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">not_in_jeff33_a_list</span><span class="p">,</span><span class="n">not_in_jeff33_z_list</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">not_in_jeff33_z_list</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Not in JEF33&#39;</span><span class="p">)</span>
    <span class="n">scat3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">not_in_endf4_a_list</span><span class="p">,</span><span class="n">not_in_endf4_z_list</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">not_in_endf4_z_list</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Not in ENDF4&#39;</span><span class="p">)</span>
    
    <span class="c1">#cb = plt.colorbar(scat, spacing=&#39;proportional&#39;,ticks=bounds)</span>
    <span class="c1">#plt.imshow(ras, cmap=cmap, clim=(elev_min, elev_max), norm=MidpointNormalize(midpoint=mid_val,vmin=elev_min, vmax=elev_max))</span>

    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scat_a_z</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;proportional&#39;</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;JEF33 &lt; ENDF4              JEF33 &gt; ENDF4&#39;</span><span class="p">)</span>
    <span class="c1"># create the colorbar</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative Difference in Percent between ENDF4 and JEF33 Fission Yields&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># for i, txt in enumerate(label_list):</span>
    <span class="c1">#   plt.annotate(txt, (a_list1[i], z_list1[i]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_compare_libs</span><span class="p">(</span><span class="n">lib1_path</span><span class="p">,</span> <span class="n">lib2_path</span><span class="p">,</span> <span class="n">fissile_parent</span><span class="p">):</span>

    <span class="n">fy_dict1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">lib1_path</span><span class="p">)</span>
    <span class="n">fy_dict2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">lib2_path</span><span class="p">)</span>

    <span class="n">unordered_keys1</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict1</span><span class="p">)</span>
    <span class="n">unordered_keys2</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict2</span><span class="p">)</span>

    <span class="n">ordered_keys1</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">unordered_keys1</span><span class="p">)</span>
    <span class="n">ordered_keys2</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">unordered_keys2</span><span class="p">)</span>

    <span class="n">rel_diff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">abs_diff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nucl_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_list1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fy_list2</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># sum over fy in list 1</span>
    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="n">fy_1</span> <span class="o">=</span> <span class="n">fy_dict1</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fy_list1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fy_1</span><span class="p">)</span>

    <span class="c1"># sum over fy in list 2</span>
    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
        <span class="n">fy_2</span> <span class="o">=</span> <span class="n">fy_dict2</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fy_list2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fy_2</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">fy_1</span> <span class="o">=</span> <span class="n">fy_dict1</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fy_2</span> <span class="o">=</span> <span class="n">fy_dict2</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">fissile_parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">fy_1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy_2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">fy_1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fy_2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if fy1 = 0 but fy2 != 1, set label to 100%. The inverse situation yield - 100%</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">fy_2</span> <span class="o">-</span> <span class="n">fy_1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">fy_1</span>

            <span class="n">abs_diff_val</span> <span class="o">=</span> <span class="n">fy_2</span> <span class="o">-</span><span class="n">fy_1</span>

            <span class="n">rel_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_diff_val</span><span class="p">)</span>
            <span class="n">abs_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abs_diff_val</span><span class="p">)</span>


            <span class="n">nucl_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>

    <span class="n">x_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">))]</span>

    <span class="n">z_vect</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_z_vect</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nucl_list</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">z_vect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nucl_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">x_z_vect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">49</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative percent difference between fission yield data&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_z_vect</span><span class="p">,</span> <span class="n">z_vect</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">rel_diff</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative percent difference&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Atomic number&#39;</span><span class="p">)</span>
    <span class="c1">#plt.yscale(&#39;log&#39;)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">nucl_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">rel_diff</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="c1">#plt.yscale(&#39;log&#39;)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">nucl_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">abs_diff</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="c1"># plt.plot(x_vect, [100]*len(rel_diff), &#39;k&#39;)</span>
    <span class="c1"># plt.plot(x_vect, [-100]*len(rel_diff), &#39;k&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>



    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">plot_compare_libs_sum_over_parents</span><span class="p">(</span><span class="n">lib1_path</span><span class="p">,</span> <span class="n">lib2_path</span><span class="p">,</span> <span class="n">parent_list</span><span class="p">):</span>

    <span class="n">fy_dict1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">lib1_path</span><span class="p">)</span>
    <span class="n">fy_dict2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">read_fy_lib</span><span class="p">(</span><span class="n">lib2_path</span><span class="p">)</span>

    <span class="n">unordered_keys1</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict1</span><span class="p">)</span>
    <span class="n">unordered_keys2</span> <span class="o">=</span> <span class="n">get_keylist_from_dict</span><span class="p">(</span><span class="n">fy_dict2</span><span class="p">)</span>

    <span class="n">ordered_keys1</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">unordered_keys1</span><span class="p">)</span>
    <span class="n">ordered_keys2</span> <span class="o">=</span> <span class="n">order_nuclide_per_z</span><span class="p">(</span><span class="n">unordered_keys2</span><span class="p">)</span>

    <span class="n">rel_diff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">abs_diff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nucl_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># fy_list1 = []</span>
    <span class="c1"># fy_list2 = []</span>

    <span class="c1"># # sum over fy in list 1</span>
    <span class="c1"># for nuclide in ordered_keys1:</span>
    <span class="c1">#   sum_fy = 0</span>
    <span class="c1">#   for parent in parent_list:</span>
    <span class="c1">#       sum_fy += fy_dict1[nuclide][parent][0]</span>
    <span class="c1">#   fy_list1.append(sum_fy)</span>

    <span class="c1"># # sum over fy in list 2</span>
    <span class="c1"># for nuclide in ordered_keys2:</span>
    <span class="c1">#   sum_fy = 0</span>
    <span class="c1">#   for parent in parent_list:</span>
    <span class="c1">#       sum_fy += fy_dict2[nuclide][parent][0]</span>
    <span class="c1">#   fy_list2.append(sum_fy)</span>


    <span class="k">for</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nuclide</span> <span class="ow">in</span> <span class="n">ordered_keys2</span><span class="p">:</span>
            <span class="n">sum_fy1</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">parent_list</span><span class="p">:</span>
                <span class="n">sum_fy1</span> <span class="o">+=</span> <span class="n">fy_dict1</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sum_fy2</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">parent_list</span><span class="p">:</span>
                <span class="n">sum_fy2</span> <span class="o">+=</span> <span class="n">fy_dict2</span><span class="p">[</span><span class="n">nuclide</span><span class="p">][</span><span class="n">parent</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>


            <span class="k">if</span> <span class="n">sum_fy1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sum_fy2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">sum_fy1</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sum_fy2</span><span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if fy1 = 0 but fy2 != 1, set label to 100%. The inverse situation yield - 100%</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rel_diff_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">sum_fy2</span> <span class="o">-</span> <span class="n">sum_fy1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">sum_fy1</span>

            <span class="n">abs_diff_val</span> <span class="o">=</span> <span class="n">sum_fy2</span> <span class="o">-</span><span class="n">sum_fy1</span>

            <span class="n">rel_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_diff_val</span><span class="p">)</span>
            <span class="n">abs_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abs_diff_val</span><span class="p">)</span>


            <span class="n">nucl_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nuclide</span><span class="p">)</span>

    <span class="n">x_vect</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">))]</span>

    <span class="n">z_vect</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_z_vect</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nucl_list</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">z_vect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nucl_list</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">x_z_vect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">49</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative percent difference between fission yield data&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_z_vect</span><span class="p">,</span> <span class="n">z_vect</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">rel_diff</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative percent difference&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Atomic number&#39;</span><span class="p">)</span>
    <span class="c1">#plt.yscale(&#39;log&#39;)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">nucl_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">rel_diff</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>
    <span class="c1">#plt.yscale(&#39;log&#39;)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">nucl_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="n">abs_diff</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="c1"># plt.plot(x_vect, [100]*len(rel_diff), &#39;k&#39;)</span>
    <span class="c1"># plt.plot(x_vect, [-100]*len(rel_diff), &#39;k&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vect</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">rel_diff</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
















<span class="c1">#### The following functions are mainly used by the NAX module</span>


<span class="c1"># This method build the fluence sequence until a final time</span>
<span class="c1"># Warning this function is only valid for non-fissile material as the flux</span>
<span class="c1"># is the same within each step</span>
<span class="k">def</span> <span class="nf">get_fluence_seq_until_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">final_time</span><span class="p">):</span>

    <span class="n">final_step</span> <span class="o">=</span> <span class="n">find_step_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">final_time</span><span class="p">)</span>
    <span class="n">extra_fluence</span> <span class="o">=</span> <span class="n">get_extra_fluence_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">final_time</span><span class="p">)</span>
    <span class="n">fluence_seq</span> <span class="o">=</span> <span class="n">get_fluence_seq</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

    <span class="n">fluence_seq_until_time</span> <span class="o">=</span> <span class="n">fluence_seq</span><span class="p">[:</span><span class="n">final_step</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">fluence_seq</span><span class="p">[</span><span class="n">final_step</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_fluence</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fluence_seq_until_time</span>

<span class="k">def</span> <span class="nf">get_fluence_subseq_until_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">final_time</span><span class="p">):</span>

    <span class="n">final_substep</span> <span class="o">=</span><span class="n">find_substep_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">final_time</span><span class="p">)</span>
    <span class="n">extra_fluence</span> <span class="o">=</span> <span class="n">get_extra_subfluence_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">final_time</span><span class="p">)</span>
    <span class="n">fluence_subseq</span> <span class="o">=</span> <span class="n">get_fluence_subseq</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

    <span class="n">fluence_subseq_until_time</span> <span class="o">=</span> <span class="n">fluence_subseq</span><span class="p">[:</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">fluence_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="p">]</span> <span class="o">+</span> <span class="n">extra_fluence</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fluence_subseq_until_time</span>

<span class="c1"># This function calculate the additional fluence from the previous time point</span>
<span class="c1"># to where the final time is set</span>
<span class="k">def</span> <span class="nf">get_extra_fluence_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>

    <span class="n">step</span> <span class="o">=</span> <span class="n">find_step_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">dens_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="c1"># flux seq has an added zero at the beginning of the arry</span>
    <span class="n">flux</span> <span class="o">=</span> <span class="n">read_flux</span><span class="p">(</span><span class="n">dens_file</span><span class="p">)[</span><span class="n">step</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">previous_time_point</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">dens_file</span><span class="p">)[</span><span class="n">step</span><span class="p">]</span>

    <span class="n">time_int</span> <span class="o">=</span> <span class="n">time</span><span class="o">-</span><span class="n">previous_time_point</span>

    <span class="k">return</span> <span class="n">flux</span><span class="o">*</span><span class="n">time_int</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span>

<span class="c1"># This function calculate the additional fluence from the previous time point</span>
<span class="c1"># to where the final time is set</span>
<span class="c1"># From subdens file</span>
<span class="k">def</span> <span class="nf">get_extra_subfluence_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>

    <span class="n">substep</span> <span class="o">=</span> <span class="n">find_substep_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">subdens_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_subdens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="c1"># flux seq has an added zero at the beginning of the arry</span>

    <span class="n">flux_subseq</span> <span class="o">=</span> <span class="n">read_flux_subseq</span><span class="p">(</span><span class="n">subdens_file</span><span class="p">)</span>
    <span class="n">flux</span><span class="o">=</span> <span class="n">flux_subseq</span><span class="p">[</span><span class="n">substep</span><span class="p">]</span>
    <span class="c1"># Subdens output not yet under new format</span>
    <span class="n">previous_time_point</span> <span class="o">=</span> <span class="n">read_time_seq_old_version</span><span class="p">(</span><span class="n">subdens_file</span><span class="p">)[</span><span class="n">substep</span><span class="p">]</span>

    <span class="n">time_int</span> <span class="o">=</span> <span class="n">time</span><span class="o">-</span><span class="n">previous_time_point</span>

    <span class="k">return</span> <span class="n">flux</span><span class="o">*</span><span class="n">time_int</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span>


<span class="k">def</span> <span class="nf">find_step_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>

    <span class="n">dens_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/output_summary/</span><span class="si">{}</span><span class="s1">_dens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq</span><span class="p">(</span><span class="n">dens_file</span><span class="p">)</span>

    <span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">step</span>

<span class="k">def</span> <span class="nf">find_substep_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>

    <span class="n">subdens_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_subdens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
    <span class="c1"># Subdens output not yet under new format</span>
    <span class="n">time_seq</span> <span class="o">=</span> <span class="n">read_time_seq_old_version</span><span class="p">(</span><span class="n">subdens_file</span><span class="p">)</span>

    <span class="n">substep</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">substep</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">substep</span>


<span class="k">def</span> <span class="nf">get_step_fluence_length</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>

    <span class="n">fluence_seq</span> <span class="o">=</span> <span class="n">get_fluence_seq</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

    <span class="n">step_fluence_length</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fluence_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fluence_seq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
    
    <span class="k">return</span> <span class="n">step_fluence_length</span>


<span class="k">def</span> <span class="nf">get_pu_subseq_mat</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">EFPD</span><span class="p">):</span>

    <span class="n">final_substep</span> <span class="o">=</span><span class="n">find_substep_from_time</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">EFPD</span><span class="p">)</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span><span class="s1">&#39;/</span><span class="si">{}</span><span class="s1">_subdens&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="n">name_list</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">Pu_isotopes_name</span>
    
    <span class="c1"># Subdens output not yet under new format</span>
    <span class="n">time_subseq</span> <span class="o">=</span> <span class="n">read_time_seq_old_version</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">t_before</span> <span class="o">=</span> <span class="n">time_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="p">]</span>
    <span class="n">t_after</span> <span class="o">=</span> <span class="n">time_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">pu_subseq_mat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
        <span class="n">dens_subseq</span> <span class="o">=</span> <span class="n">read_dens_old_version</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">dens_subseq_until_time</span> <span class="o">=</span> <span class="n">dens_subseq</span><span class="p">[:</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dens_before</span> <span class="o">=</span> <span class="n">dens_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="p">]</span>
        <span class="n">dens_after</span> <span class="o">=</span> <span class="n">dens_subseq</span><span class="p">[</span><span class="n">final_substep</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pair1</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_before</span><span class="p">,</span> <span class="n">dens_before</span><span class="p">]</span>
        <span class="n">pair2</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_after</span><span class="p">,</span> <span class="n">dens_after</span><span class="p">]</span>
        <span class="n">interpolated_dens</span> <span class="o">=</span> <span class="n">interpolation_between_two_points</span><span class="p">(</span><span class="n">pair1</span><span class="p">,</span> <span class="n">pair2</span><span class="p">,</span> <span class="n">EFPD</span><span class="p">)</span>
        <span class="n">dens_subseq</span> <span class="o">=</span> <span class="n">dens_subseq_until_time</span> <span class="o">+</span> <span class="p">[</span><span class="n">interpolated_dens</span><span class="p">]</span>

        <span class="n">pu_subseq_mat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dens_subseq</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pu_subseq_mat</span>



<span class="k">class</span> <span class="nc">xs_name_not_found</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Raise when the user tries to access fission XS for a nuclide which fission XS have not been set yet &quot;&quot;&quot;</span>
    <span class="k">pass</span>





<span class="c1"># def bucells_average_density(bucell_list, step_list):</span>

<span class="c1">#   bucell_vol_list = []</span>

<span class="c1">#   system_parameters_file = open(os.getcwd() + &#39;/output_summary/system_parameters&#39;)</span>
    







 
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Julien de Troullioud de Lanversin

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</body>
</html>