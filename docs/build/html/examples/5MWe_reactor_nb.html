

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5-MWe - reactor simulation &mdash; ONIX Documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Irradiation of a slab of U-238" href="largo6_nb.html" />
    <link rel="prev" title="Assembly simulation" href="assembly_nb.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #0d0d0d" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#reactor-simulation">Reactor Simulation</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html#coupled-simulations">Coupled simulations</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pincell_nb.html">Fuel pin-cell simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="assembly_nb.html">Assembly simulation</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">5-MWe - reactor simulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#standalone-simulation">Standalone simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#nuclear-archaeology">Nuclear Archaeology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pythonapi/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License Agreement</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ONIX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples</a> &raquo;</li>
        
      <li>5-MWe - reactor simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/5MWe_reactor_nb.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="5-MWe---reactor-simulation">
<h1>5-MWe - reactor simulation<a class="headerlink" href="#5-MWe---reactor-simulation" title="Permalink to this headline">¶</a></h1>
<p>This notebook shows the input file for modeling and simulating the 5-MWe reactor in North Korea with ONIX.</p>
<div class="section" id="OpenMC-input-part">
<h2>OpenMC input part<a class="headerlink" href="#OpenMC-input-part" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">openmc</span>
<span class="kn">import</span> <span class="nn">onix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-51377a570dec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">import</span> openmc
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">import</span> onix

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;openmc&#39;
</pre></div></div>
</div>
<p>The 5-MWe is made of graphite blocks with fuel channels through which carbon dioxyde gas flows to cool the fuel rod. The fuel rod is made of natural uranium and is cladded with magnox alloy (an alloy of magnesium with small amount of aluminum and other metals).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">natU_mat</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">()</span>
<span class="n">natU_mat</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">800</span>
<span class="n">natU_mat</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;g/cc&#39;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">17.98</span><span class="p">)</span>
<span class="n">natU_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U234&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">NATURAL_ABUNDANCE</span><span class="p">[</span><span class="s1">&#39;U234&#39;</span><span class="p">])</span>
<span class="n">natU_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U235&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">NATURAL_ABUNDANCE</span><span class="p">[</span><span class="s1">&#39;U235&#39;</span><span class="p">])</span>
<span class="n">natU_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U238&#39;</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">NATURAL_ABUNDANCE</span><span class="p">[</span><span class="s1">&#39;U238&#39;</span><span class="p">])</span>

<span class="n">clad_mat</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">()</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">700</span>
<span class="n">Mg_frac</span> <span class="o">=</span> <span class="mf">98.95</span>
<span class="n">Al_frac</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Be_frac</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Mg24&#39;</span><span class="p">,</span><span class="mf">0.79</span><span class="o">*</span><span class="n">Mg_frac</span><span class="p">)</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Mg25&#39;</span><span class="p">,</span><span class="mf">0.10</span><span class="o">*</span><span class="n">Mg_frac</span><span class="p">)</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Mg26&#39;</span><span class="p">,</span><span class="mf">0.11</span><span class="o">*</span><span class="n">Mg_frac</span><span class="p">)</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Al27&#39;</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">Al_frac</span><span class="p">)</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Be9&#39;</span><span class="p">,</span><span class="mi">1</span><span class="o">*</span><span class="n">Be_frac</span><span class="p">)</span>
<span class="n">clad_mat</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;g/cc&#39;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">1.65</span><span class="p">)</span>

<span class="n">mod_mat</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">()</span>
<span class="n">mod_mat</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">650</span>
<span class="n">mod_mat</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;g/cc&#39;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">1.628</span><span class="p">)</span>
<span class="n">mod_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span><span class="mf">0.989</span><span class="p">)</span>
<span class="n">mod_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;C13&#39;</span><span class="p">,</span><span class="mf">0.011</span><span class="p">)</span>
<span class="n">mod_mat</span><span class="o">.</span><span class="n">add_s_alpha_beta</span><span class="p">(</span><span class="s1">&#39;c_Graphite&#39;</span><span class="p">)</span>

<span class="n">sample_mat</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">()</span>
<span class="n">sample_mat</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">650</span>
<span class="n">sample_mat</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;g/cc&#39;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">1.628</span><span class="p">)</span>
<span class="n">sample_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span><span class="mf">0.989</span><span class="p">)</span>
<span class="n">sample_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;C13&#39;</span><span class="p">,</span><span class="mf">0.011</span><span class="p">)</span>
<span class="n">sample_mat</span><span class="o">.</span><span class="n">add_s_alpha_beta</span><span class="p">(</span><span class="s1">&#39;c_Graphite&#39;</span><span class="p">)</span>

<span class="n">cool_mat</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">()</span>
<span class="n">cool_mat</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">650</span>
<span class="n">cool_mat</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;g/cc&#39;</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">1.628</span><span class="p">)</span>
<span class="n">C_frac</span> <span class="o">=</span> <span class="mf">33.33</span>
<span class="n">O_frac</span> <span class="o">=</span> <span class="mf">66.66</span>
<span class="n">cool_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span><span class="n">C_frac</span><span class="o">*</span><span class="mf">0.989</span><span class="p">)</span>
<span class="n">cool_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;C13&#39;</span><span class="p">,</span><span class="n">C_frac</span><span class="o">*</span><span class="mf">0.011</span><span class="p">)</span>
<span class="n">cool_mat</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;O16&#39;</span><span class="p">,</span><span class="n">O_frac</span><span class="o">*</span><span class="mf">0.9976</span><span class="p">)</span>
<span class="c1"># Instantiate a Materials collection</span>
<span class="n">materials_file</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Materials</span><span class="p">([</span><span class="n">natU_mat</span><span class="p">,</span> <span class="n">clad_mat</span><span class="p">,</span> <span class="n">cool_mat</span><span class="p">,</span> <span class="n">mod_mat</span><span class="p">,</span> <span class="n">sample_mat</span><span class="p">])</span>
<span class="c1">#materials_file.cross_sections = &#39;/tigress/jdtdl/openmc/mcnp_endfb70/cross_sections.xml&#39;</span>
<span class="n">materials_file</span><span class="o">.</span><span class="n">cross_sections</span> <span class="o">=</span> <span class="s1">&#39;/home/groups/rewing1/cross-sections/lib80x_hdf5/cross_sections.xml&#39;</span>

<span class="c1"># Export to &quot;materials.xml&quot;</span>
<span class="n">materials_file</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The following commands define the geometry and the cells.</p>
<p>In order to measure neutronics parameters toward the edges of the fuel channels (against the wall of the graphite block), a sample cell is added. This cell allows to tally reaction rates and neutron flux for nuclear archaeology methods that would use a monitor tag located in this region.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create cylinders for the fuel and clad</span>
<span class="n">fuel_outer_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">1.45</span><span class="p">)</span>
<span class="n">clad_outer_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">1.50</span><span class="p">)</span>
<span class="n">coolant_outer_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">3.25</span><span class="p">)</span>

<span class="c1">#Create cylinder of the sample</span>
<span class="n">sample_cylinder</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">3.35</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Create boundary planes to surround the geometry</span>
<span class="n">min_x</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">XPlane</span><span class="p">(</span><span class="n">x0</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;reflective&#39;</span><span class="p">)</span>
<span class="n">max_x</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">XPlane</span><span class="p">(</span><span class="n">x0</span><span class="o">=+</span><span class="mi">10</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;reflective&#39;</span><span class="p">)</span>
<span class="n">min_y</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">YPlane</span><span class="p">(</span><span class="n">y0</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;reflective&#39;</span><span class="p">)</span>
<span class="n">max_y</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">YPlane</span><span class="p">(</span><span class="n">y0</span><span class="o">=+</span><span class="mi">10</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;reflective&#39;</span><span class="p">)</span>
<span class="n">min_z</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZPlane</span><span class="p">(</span><span class="n">z0</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;reflective&#39;</span><span class="p">)</span>
<span class="n">max_z</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZPlane</span><span class="p">(</span><span class="n">z0</span><span class="o">=+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;reflective&#39;</span><span class="p">)</span>

<span class="c1"># Create a Universe to encapsulate the fuel pin</span>
<span class="n">pin_cell_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fuel Pin&#39;</span><span class="p">)</span>

<span class="c1"># Create fuel1 Cell</span>
<span class="n">fuel_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;fuel&#39;</span><span class="p">)</span>
<span class="n">fuel_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">natU_mat</span>
<span class="n">fuel_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">-</span><span class="n">fuel_outer_radius</span>
<span class="n">pin_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">fuel_cell</span><span class="p">)</span>

<span class="c1"># Create a clad Cell for 1</span>
<span class="n">clad_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Clad&#39;</span><span class="p">)</span>
<span class="n">clad_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">clad_mat</span>
<span class="n">clad_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_outer_radius</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">clad_outer_radius</span>
<span class="n">pin_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">clad_cell</span><span class="p">)</span>

<span class="c1"># Create a coolant Cell for 1</span>
<span class="n">cool_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cool&#39;</span><span class="p">)</span>
<span class="n">cool_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">cool_mat</span>
<span class="n">cool_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">clad_outer_radius</span> <span class="o">&amp;</span> <span class="o">-</span> <span class="n">coolant_outer_radius</span>
<span class="n">pin_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">cool_cell</span><span class="p">)</span>

<span class="c1"># Create a moderator Cell for 1</span>
<span class="n">mod_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Mod&#39;</span><span class="p">)</span>
<span class="n">mod_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod_mat</span>
<span class="n">mod_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">coolant_outer_radius</span> <span class="o">&amp;</span> <span class="o">+</span><span class="n">sample_cylinder</span>
<span class="n">pin_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">mod_cell</span><span class="p">)</span>

<span class="c1"># Create sample cell</span>
<span class="n">sample_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Sample&#39;</span><span class="p">)</span>
<span class="n">sample_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">sample_mat</span>
<span class="n">sample_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">-</span><span class="n">sample_cylinder</span>
<span class="n">pin_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">sample_cell</span><span class="p">)</span>

<span class="c1"># Create root Cell</span>
<span class="n">root_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;root cell&#39;</span><span class="p">)</span>
<span class="n">root_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">pin_cell_universe</span>
<span class="n">root_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">min_x</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">max_x</span> <span class="o">&amp;</span> <span class="o">+</span><span class="n">min_y</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">max_y</span> <span class="o">&amp;</span> <span class="o">+</span><span class="n">min_z</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">max_z</span>

<span class="c1"># Create root Universe</span>
<span class="n">root_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">universe_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;root universe&#39;</span><span class="p">)</span>
<span class="n">root_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">root_cell</span><span class="p">)</span>

<span class="c1"># Create Geometry and set root Universe</span>
<span class="n">openmc_geometry</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Geometry</span><span class="p">(</span><span class="n">root_universe</span><span class="p">)</span>

<span class="c1"># Export to &quot;materials.xml&quot;</span>
<span class="n">materials_file</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
<span class="c1"># Export to &quot;geometry.xml&quot;</span>
<span class="n">openmc_geometry</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The following commands are for the simulations settings of OpenMC.</p>
<p>There are no particular requirements from ONIX here so users can input these commands as they would for a normal OpenMC simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># OpenMC simulation parameters</span>
<span class="n">batches</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inactive</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">particles</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Instantiate a Settings object</span>
<span class="n">settings_file</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Settings</span><span class="p">()</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">batches</span> <span class="o">=</span> <span class="n">batches</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">inactive</span> <span class="o">=</span> <span class="n">inactive</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">particles</span> <span class="o">=</span> <span class="n">particles</span>

<span class="c1"># Create an initial uniform spatial source distribution over fissionable zones</span>
<span class="c1">#bounds = [-0.65635, -0.65635, -0.65635, 0.65635, 0.65635, 0.65635]</span>
<span class="c1">#uniform_dist = openmc.stats.Box(bounds[:3], bounds[3:], only_fissionable=True)</span>
<span class="n">point_dist</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">point_dist</span><span class="p">)</span>

<span class="c1"># Export to &quot;settings.xml&quot;</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ONIX-input-part">
<h2>ONIX input part<a class="headerlink" href="#ONIX-input-part" title="Permalink to this headline">¶</a></h2>
<p>This section describes the input commands for ONIX.</p>
<div class="section" id="Defning-a-sequence">
<h3>Defning a sequence<a class="headerlink" href="#Defning-a-sequence" title="Permalink to this headline">¶</a></h3>
<p>As we assume that the 5-MWe reactor has never been operated to a burnup higher than 0.7 MWd/kg, we define a burnup interval up to that value. With a total active volume of approximately 166 cubic meters and a nominal thermal power output of 25 MWth, the volumic power density is set to 0.15 kW/l (other power densities yield almost identical neutronics results and therefore this value can be used for other thermal power values).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">macrostep_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0087</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">macrostep_unit</span> <span class="o">=</span> <span class="s1">&#39;MWd/kg&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">norma_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">macrostep_vector</span><span class="p">)</span>
<span class="n">norma_unit</span> <span class="o">=</span> <span class="s1">&#39;power&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">microstep_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">macrostep_vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sequence1</span> <span class="o">=</span> <span class="n">onix</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_macrostep</span><span class="p">(</span><span class="n">macrostep_vector</span><span class="p">,</span> <span class="n">macrostep_unit</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_norma</span><span class="p">(</span><span class="n">norma_vector</span><span class="p">,</span> <span class="n">norma_unit</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">microstep_vector</span> <span class="o">=</span> <span class="n">microstep_vector</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sequence1</span><span class="o">.</span><span class="n">flux_approximation</span> <span class="o">=</span><span class="s1">&#39;iv&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span> <span class="o">=</span> <span class="n">onix</span><span class="o">.</span><span class="n">couple</span><span class="o">.</span><span class="n">Couple_openmc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">set_bounding_box</span><span class="p">([</span><span class="o">-</span><span class="mf">10.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.16</span><span class="p">,</span> <span class="mf">10.16</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">openmc_bin_path</span> <span class="o">=</span> <span class="s1">&#39;/home/julien/virtualenvs/py3/bin/openmc&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">select_bucells</span><span class="p">([</span><span class="n">fuel_cell</span><span class="p">,</span> <span class="n">sample_cell</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">import_openmc</span><span class="p">(</span><span class="n">root_cell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vol_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fuel&#39;</span><span class="p">:</span> <span class="mf">6.6051</span><span class="p">,</span> <span class="s1">&#39;Sample&#39;</span><span class="p">:</span><span class="mf">0.03141</span> <span class="p">,</span><span class="s1">&#39;total volume&#39;</span><span class="p">:</span><span class="mi">400</span><span class="p">}</span>
<span class="n">couple</span><span class="o">.</span><span class="n">set_vol</span><span class="p">(</span><span class="n">vol_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">set_sequence</span><span class="p">(</span><span class="n">sequence1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can finally ask ONIX to burn the system and launch the coupled simulation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">burn</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Output results are going to be located in two types of folder. Per step folders include densities, power, neutron flux, burnup, one-group cross sections and burnup matrices for each macrostep, separately. The output summary folder contains aggregated output results for the whole simulation and for every macrostep.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="largo6_nb.html" class="btn btn-neutral float-right" title="Irradiation of a slab of U-238" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="assembly_nb.html" class="btn btn-neutral float-left" title="Assembly simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Julien de Troullioud de Lanversin

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</body>
</html>