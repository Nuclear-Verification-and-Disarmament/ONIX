

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Assembly simulation &mdash; ONIX Documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5-MWe - reactor simulation" href="5MWe_reactor_nb.html" />
    <link rel="prev" title="Fuel pin-cell simulation" href="pincell_nb.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #0d0d0d" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes/index.html">Release Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#reactor-simulation">Reactor Simulation</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html#coupled-simulations">Coupled simulations</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pincell_nb.html">Fuel pin-cell simulation</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Assembly simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="5MWe_reactor_nb.html">5-MWe - reactor simulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="index.html#standalone-simulation">Standalone simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#nuclear-archaeology">Nuclear Archaeology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pythonapi/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License Agreement</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ONIX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples</a> &raquo;</li>
        
      <li>Assembly simulation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/assembly_nb.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Assembly-simulation">
<h1>Assembly simulation<a class="headerlink" href="#Assembly-simulation" title="Permalink to this headline">¶</a></h1>
<p>This notebook shows how ONIX can be used to run a coupled simulation of an LWR assembly. Since this model uses coupling with OpenMC, it is necessary to have OpenMC installed.</p>
<div class="section" id="OpenMC-input-part">
<h2>OpenMC input part<a class="headerlink" href="#OpenMC-input-part" title="Permalink to this headline">¶</a></h2>
<p>ONIX python input commands should be located just after OpenMC python commands in the same python input file. The OpenMC part of the input file is the same as the one you would use to launch an OpenMC simulation. Users should refer to OpenMC documentation for the corresponding Python API. In this example, however, the OpenMC part of the input file is included to better explain the articulation of ONIX with OpenMC.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">openmc</span>
<span class="kn">import</span> <span class="nn">onix</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-51377a570dec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">import</span> openmc
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">import</span> onix

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;openmc&#39;
</pre></div></div>
</div>
<p>This part of the OpenMC input commands create the materials that will fill the OpenMC cells.</p>
<p><strong>Important to note</strong>: since ONIX cannot handle elements but only isotopes, users should only use the command “add_nuclide” for materials that are going to be depleted by ONIX. Other materials not depleted by ONIX can use “add_element”.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># All densities are in atm/(barn*cm)</span>

<span class="c1">#LEU fuel (U)</span>
<span class="c1"># Enrichment 3.8 wt% in 235</span>
<span class="c1"># Fuel density 10.4 g cm3</span>
<span class="n">U234_dens</span> <span class="o">=</span> <span class="mf">8.492176928241094e-6</span>
<span class="n">U235_dens</span> <span class="o">=</span> <span class="mf">8.921015824220379e-4</span>
<span class="n">U238_dens</span> <span class="o">=</span> <span class="mf">2.2302847635443696e-2</span>
<span class="n">O16_dens</span> <span class="o">=</span> <span class="mf">4.640688278958795e-2</span>
<span class="n">tot_dens</span> <span class="o">=</span><span class="n">U234_dens</span><span class="o">+</span> <span class="n">U235_dens</span> <span class="o">+</span> <span class="n">U238_dens</span> <span class="o">+</span> <span class="n">O16_dens</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;atom/b-cm&#39;</span><span class="p">,</span> <span class="n">tot_dens</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U234&#39;</span><span class="p">,</span> <span class="n">U234_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U235&#39;</span><span class="p">,</span> <span class="n">U235_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U238&#39;</span><span class="p">,</span> <span class="n">U238_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">U</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;O16&#39;</span><span class="p">,</span> <span class="n">O16_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>

<span class="c1"># Gd Fuel</span>
<span class="c1"># Enrichment 2.6 wt% in 235</span>
<span class="c1"># Fuel density 10.4 g cm3</span>
<span class="c1"># Enrichment in Gd2O3 is 7%</span>
<span class="n">U235_dens</span> <span class="o">=</span> <span class="mf">5.6796569966758324e-4</span>
<span class="n">U238_dens</span> <span class="o">=</span> <span class="mf">2.100811730537396e-2</span>
<span class="n">O16_dens_fromUO2</span> <span class="o">=</span> <span class="mf">4.315216601008309e-2</span>
<span class="n">Gd152_dens</span> <span class="o">=</span> <span class="mf">5.007610609954495e-6</span>
<span class="n">Gd154_dens</span> <span class="o">=</span> <span class="mf">5.3873340627459146e-5</span>
<span class="n">Gd155_dens</span> <span class="o">=</span> <span class="mf">3.6338064112348325e-4</span>
<span class="n">Gd156_dens</span> <span class="o">=</span> <span class="mf">4.993729503352673e-4</span>
<span class="n">Gd157_dens</span> <span class="o">=</span> <span class="mf">3.7934991657329525e-4</span>
<span class="n">Gd158_dens</span> <span class="o">=</span> <span class="mf">5.982987297594215e-4</span>
<span class="n">Gd160_dens</span> <span class="o">=</span> <span class="mf">5.199279101704396e-4</span>
<span class="n">O16_dens_fromGd2O3</span> <span class="o">=</span> <span class="mf">3.628816648798981e-3</span>
<span class="n">tot_dens</span> <span class="o">=</span> <span class="n">U235_dens</span><span class="o">+</span><span class="n">U238_dens</span><span class="o">+</span><span class="n">Gd152_dens</span><span class="o">+</span><span class="n">Gd154_dens</span><span class="o">+</span><span class="n">Gd155_dens</span><span class="o">+</span><span class="n">Gd156_dens</span><span class="o">+</span><span class="n">Gd157_dens</span><span class="o">+</span><span class="n">Gd158_dens</span><span class="o">+</span><span class="n">Gd160_dens</span><span class="o">+</span><span class="n">O16_dens_fromUO2</span><span class="o">+</span><span class="n">O16_dens_fromGd2O3</span>
<span class="n">GD</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GD&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;atom/b-cm&#39;</span><span class="p">,</span> <span class="n">tot_dens</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U235&#39;</span><span class="p">,</span> <span class="n">U235_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;U238&#39;</span><span class="p">,</span> <span class="n">U238_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;O16&#39;</span><span class="p">,</span> <span class="n">O16_dens_fromUO2</span><span class="o">+</span><span class="n">O16_dens_fromGd2O3</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd152&#39;</span><span class="p">,</span> <span class="n">Gd152_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd154&#39;</span><span class="p">,</span> <span class="n">Gd154_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd155&#39;</span><span class="p">,</span> <span class="n">Gd155_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd156&#39;</span><span class="p">,</span> <span class="n">Gd156_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd157&#39;</span><span class="p">,</span> <span class="n">Gd157_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd158&#39;</span><span class="p">,</span> <span class="n">Gd158_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">GD</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;Gd160&#39;</span><span class="p">,</span> <span class="n">Gd160_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>

<span class="c1">#clad</span>
<span class="c1"># Zircaloy-4 (ref zircaloy-4.pdf)</span>
<span class="n">Tin_dens</span> <span class="o">=</span> <span class="mf">1.50</span>
<span class="n">Fe_dens</span> <span class="o">=</span> <span class="mf">0.20</span>
<span class="n">Cr_dens</span> <span class="o">=</span> <span class="mf">0.10</span>
<span class="n">Zr_dens</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">Tin_dens</span> <span class="o">-</span> <span class="n">Fe_dens</span> <span class="o">-</span> <span class="n">Cr_dens</span>
<span class="n">clad</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;clad&#39;</span><span class="p">)</span>
<span class="n">clad</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;g/cm3&#39;</span><span class="p">,</span> <span class="mf">6.55</span><span class="p">)</span>
<span class="n">clad</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="s1">&#39;Zr&#39;</span><span class="p">,</span> <span class="n">Zr_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;wo&#39;</span><span class="p">)</span>
<span class="n">clad</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="s1">&#39;Sn&#39;</span><span class="p">,</span> <span class="n">Tin_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;wo&#39;</span><span class="p">)</span>
<span class="n">clad</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="s1">&#39;Cr&#39;</span><span class="p">,</span> <span class="n">Cr_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;wo&#39;</span><span class="p">)</span>
<span class="n">clad</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">Fe_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;wo&#39;</span><span class="p">)</span>

<span class="c1"># mod</span>
<span class="c1"># Boron concentration:</span>
<span class="n">H_dens</span> <span class="o">=</span> <span class="mf">4.32002334608591e-2</span>
<span class="n">O16_dens</span> <span class="o">=</span> <span class="mf">2.160011673042955e-2</span>
<span class="n">B10_dens</span> <span class="o">=</span> <span class="mf">6.949982545596444e-06</span>
<span class="n">B11_dens</span> <span class="o">=</span> <span class="mf">2.7799930182385777e-05</span>
<span class="n">tot_dens</span> <span class="o">=</span> <span class="n">H_dens</span><span class="o">+</span><span class="n">O16_dens</span><span class="o">+</span><span class="n">B10_dens</span><span class="o">+</span><span class="n">B11_dens</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mod&#39;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">set_density</span><span class="p">(</span><span class="s1">&#39;atom/b-cm&#39;</span><span class="p">,</span> <span class="n">tot_dens</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="n">H_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="n">B10_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="n">B11_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">add_nuclide</span><span class="p">(</span><span class="s1">&#39;O16&#39;</span><span class="p">,</span> <span class="n">O16_dens</span><span class="p">,</span> <span class="n">percent_type</span> <span class="o">=</span> <span class="s1">&#39;ao&#39;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">add_s_alpha_beta</span><span class="p">(</span><span class="s1">&#39;c_H_in_H2O&#39;</span><span class="p">)</span>

<span class="c1"># Instantiate a Materials collection</span>
<span class="n">materials_file</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Materials</span><span class="p">([</span><span class="n">U</span><span class="p">,</span> <span class="n">GD</span><span class="p">,</span> <span class="n">clad</span> <span class="p">,</span> <span class="n">mod</span><span class="p">])</span>
<span class="c1">#materials_file.cross_sections = &#39;/tigress/jdtdl/openmc/cross-sections/lib80x_hdf5/cross_sections.xml&#39;</span>

<span class="c1"># Export to &quot;materials.xml&quot;</span>
<span class="n">materials_file</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The following commands define the geometry and the cells.</p>
<p><strong>Important to note</strong>: ONIX requires the user to define a root cell that is named “root cell”. This root cell will be used to fill the root universe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Create cylinders for the fuel and clad</span>
<span class="n">fuel_outer_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.4025</span><span class="p">)</span>
<span class="c1"># The cladding inner radius was set equal to fuel outer radius for simplication</span>
<span class="n">fuel_clad_outer_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.475</span><span class="p">)</span>


<span class="c1"># Create cylinders for the guide tube</span>
<span class="n">guide_tube_inner_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.555</span><span class="p">)</span>
<span class="n">guide_tube_outer_radius</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZCylinder</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.616</span><span class="p">)</span>


<span class="n">min_z</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZPlane</span><span class="p">(</span><span class="n">z0</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">)</span>
<span class="n">max_z</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">ZPlane</span><span class="p">(</span><span class="n">z0</span><span class="o">=+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">)</span>


<span class="c1"># Create a Universe to encapsulate U cells</span>
<span class="n">U_cell_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U_universe&#39;</span><span class="p">)</span>
<span class="c1"># Create a Universe to encapsulate GD cells</span>
<span class="n">GD_cell_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GD_universe&#39;</span><span class="p">)</span>
<span class="c1"># Create a Universe to encapsulate a guide tubes</span>
<span class="n">Guide_cell_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Guide_universe&#39;</span><span class="p">)</span>
<span class="c1"># Create a Universe to encapsulate measured cell</span>
<span class="n">Measured_cell_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Measured_universe&#39;</span><span class="p">)</span>


<span class="c1"># Create U Cell</span>
<span class="n">U_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="n">U_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">U</span>
<span class="n">U_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">-</span><span class="n">fuel_outer_radius</span>
<span class="n">U_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">U_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">U_cell</span><span class="p">)</span>

<span class="c1"># Create a clad Cell for U</span>
<span class="n">U_clad_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U_clad&#39;</span><span class="p">)</span>
<span class="n">U_clad_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">clad</span>
<span class="n">U_clad_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_outer_radius</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">fuel_clad_outer_radius</span>
<span class="n">U_clad_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">U_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">U_clad_cell</span><span class="p">)</span>

<span class="c1"># Create a moderator Cell for U</span>
<span class="n">U_moderator_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;U_moderator&#39;</span><span class="p">)</span>
<span class="n">U_moderator_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod</span>
<span class="n">U_moderator_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_clad_outer_radius</span>
<span class="n">U_moderator_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">575</span> <span class="c1">################&quot; No thermac XS at 1027 so we need to set water to 575</span>
<span class="n">U_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">U_moderator_cell</span><span class="p">)</span>


<span class="c1"># Create GD Cell</span>
<span class="n">GD_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GD&#39;</span><span class="p">)</span>
<span class="n">GD_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">GD</span>
<span class="n">GD_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">-</span><span class="n">fuel_outer_radius</span>
<span class="n">GD_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">GD_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">GD_cell</span><span class="p">)</span>

<span class="c1"># Create a clad Cell for GD</span>
<span class="n">GD_clad_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GD_clad&#39;</span><span class="p">)</span>
<span class="n">GD_clad_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">clad</span>
<span class="n">GD_clad_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_outer_radius</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">fuel_clad_outer_radius</span>
<span class="n">GD_clad_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">GD_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">GD_clad_cell</span><span class="p">)</span>

<span class="c1"># Create a moderator Cell for GD</span>
<span class="n">GD_moderator_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;GD_moderator&#39;</span><span class="p">)</span>
<span class="n">GD_moderator_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod</span>
<span class="n">GD_moderator_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_clad_outer_radius</span>
<span class="n">GD_moderator_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">575</span> <span class="c1">################&quot; No thermac XS at 1027 so we need to set water to 575</span>
<span class="n">GD_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">GD_moderator_cell</span><span class="p">)</span>



<span class="c1"># Create a clad Cell for Guide</span>
<span class="n">Guide_clad_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Guide_clad&#39;</span><span class="p">)</span>
<span class="n">Guide_clad_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">clad</span>
<span class="n">Guide_clad_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">guide_tube_inner_radius</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">guide_tube_outer_radius</span>
<span class="n">Guide_clad_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">Guide_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">Guide_clad_cell</span><span class="p">)</span>

<span class="c1"># Create a moderator Cell for inside Guide</span>
<span class="n">Guide_moderator_in_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Guide_moderator_in&#39;</span><span class="p">)</span>
<span class="n">Guide_moderator_in_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod</span>
<span class="n">Guide_moderator_in_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">-</span><span class="n">guide_tube_inner_radius</span>
<span class="n">Guide_moderator_in_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">575</span> <span class="c1">################&quot; No thermal XS at 1027 so we need to set water to 575</span>
<span class="n">Guide_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">Guide_moderator_in_cell</span><span class="p">)</span>

<span class="c1"># Create a moderator Cell for outside Guide</span>
<span class="n">Guide_moderator_out_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Guide_moderator_out&#39;</span><span class="p">)</span>
<span class="n">Guide_moderator_out_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod</span>
<span class="n">Guide_moderator_out_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">guide_tube_outer_radius</span>
<span class="n">Guide_moderator_out_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">575</span> <span class="c1">################&quot; No thermal XS at 1027 so we need to set water to 575</span>
<span class="n">Guide_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">Guide_moderator_out_cell</span><span class="p">)</span>


<span class="c1"># Create measured Cell</span>
<span class="n">Measured_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Measured&#39;</span><span class="p">)</span>
<span class="n">Measured_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">U</span>
<span class="n">Measured_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">-</span><span class="n">fuel_outer_radius</span>
<span class="n">Measured_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">Measured_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">Measured_cell</span><span class="p">)</span>

<span class="c1"># Create a clad Cell for Measured Cell</span>
<span class="n">Measured_clad_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Measured_clad&#39;</span><span class="p">)</span>
<span class="n">Measured_clad_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">clad</span>
<span class="n">Measured_clad_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_outer_radius</span> <span class="o">&amp;</span> <span class="o">-</span><span class="n">fuel_clad_outer_radius</span>
<span class="n">Measured_clad_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">1027</span>
<span class="n">Measured_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">Measured_clad_cell</span><span class="p">)</span>

<span class="c1"># Create a moderator Cell for Measured Cell</span>
<span class="n">Measured_moderator_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Measured_moderator&#39;</span><span class="p">)</span>
<span class="n">Measured_moderator_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod</span>
<span class="n">Measured_moderator_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="o">+</span><span class="n">fuel_clad_outer_radius</span>
<span class="n">Measured_moderator_cell</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="mi">575</span> <span class="c1">################&quot; No thermal XS at 1027 so we need to set water to 575</span>
<span class="n">Measured_cell_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">Measured_moderator_cell</span><span class="p">)</span>

<span class="c1"># Ceate an outer-lattice cell</span>
<span class="n">outer_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;outer cell&#39;</span><span class="p">)</span>
<span class="n">outer_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">mod</span>

<span class="c1"># Create an outer-lattice universe</span>
<span class="n">outer_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;outer universe&#39;</span><span class="p">)</span>
<span class="n">outer_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">outer_cell</span><span class="p">)</span>

<span class="n">row1</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>

<span class="n">row3</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>
<span class="n">row3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row3</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row3</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>

<span class="n">row4</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row4</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row4</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>
<span class="n">row4</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>

<span class="n">row5</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row5</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>
<span class="n">row5</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row5</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row5</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>

<span class="n">row6</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row6</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row6</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>

<span class="n">row7</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row7</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row7</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>

<span class="n">row8</span> <span class="o">=</span>  <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row8</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row8</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>

<span class="n">row9</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row9</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>

<span class="n">row10</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row10</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>

<span class="n">row11</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row11</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row11</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">Measured_cell_universe</span>
<span class="n">row11</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>

<span class="n">row15</span> <span class="o">=</span> <span class="p">[</span><span class="n">U_cell_universe</span><span class="p">]</span><span class="o">*</span><span class="mi">18</span>
<span class="n">row15</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>
<span class="n">row15</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">GD_cell_universe</span>
<span class="n">row15</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">Guide_cell_universe</span>


<span class="n">lattice</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">RectLattice</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lattice&#39;</span><span class="p">)</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">]</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">lower_left</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">11.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.43</span><span class="p">]</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">universes</span> <span class="o">=</span> <span class="p">[</span><span class="n">row1</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row3</span><span class="p">,</span> <span class="n">row4</span><span class="p">,</span> <span class="n">row5</span><span class="p">,</span> <span class="n">row6</span><span class="p">,</span> <span class="n">row7</span><span class="p">,</span> <span class="n">row8</span><span class="p">,</span> <span class="n">row9</span><span class="p">,</span> <span class="n">row10</span><span class="p">,</span> <span class="n">row11</span><span class="p">,</span> <span class="n">row7</span><span class="p">,</span> <span class="n">row6</span><span class="p">,</span> <span class="n">row5</span><span class="p">,</span> <span class="n">row15</span><span class="p">,</span> <span class="n">row3</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row1</span><span class="p">]</span>

<span class="c1"># Create root Cell</span>
<span class="n">assembly_rect</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">rectangular_prism</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">22.86</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">22.86</span><span class="p">,</span> <span class="n">boundary_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">)</span>
<span class="n">root_cell</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;root cell&#39;</span><span class="p">)</span>
<span class="n">root_cell</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">assembly_rect</span>
<span class="n">root_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">lattice</span>


<span class="c1"># Create root Universe</span>
<span class="n">root_universe</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">universe_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;root universe&#39;</span><span class="p">)</span>
<span class="n">root_universe</span><span class="o">.</span><span class="n">add_cell</span><span class="p">(</span><span class="n">root_cell</span><span class="p">)</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">root_cell</span><span class="o">.</span><span class="n">region</span>


<span class="c1"># Create Geometry and set root Universe</span>
<span class="n">openmc_geometry</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Geometry</span><span class="p">(</span><span class="n">root_universe</span><span class="p">)</span>

<span class="c1"># Export to &quot;geometry.xml&quot;</span>
<span class="n">openmc_geometry</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The following command plots a cross section of the assembly</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Instantiate a Plot</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">plot_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;materials-xy&#39;</span>
<span class="n">plot</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">plot</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">]</span>
<span class="n">plot</span><span class="o">.</span><span class="n">pixels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">plot</span><span class="o">.</span><span class="n">color_by</span> <span class="o">=</span> <span class="s1">&#39;material&#39;</span>

<span class="c1"># Show plot</span>
<span class="n">openmc</span><span class="o">.</span><span class="n">plot_inline</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-960ea75871ab&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># Instantiate a Plot</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>plot <span class="ansi-blue-fg">=</span> openmc<span class="ansi-blue-fg">.</span>Plot<span class="ansi-blue-fg">(</span>plot_id<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> plot<span class="ansi-blue-fg">.</span>filename <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;materials-xy&#39;</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> plot<span class="ansi-blue-fg">.</span>origin <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> plot<span class="ansi-blue-fg">.</span>width <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">24</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">24</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;openmc&#39; is not defined
</pre></div></div>
</div>
<p>The following commands are for the simulations settings of OpenMC.</p>
<p>There are no particular requirements from ONIX here so users can input these commands as they would for a normal OpenMC simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># OpenMC simulation parameters</span>
<span class="n">batches</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">inactive</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">particles</span> <span class="o">=</span> <span class="mi">10000</span>


<span class="c1">#Instantiate a Settings object</span>
<span class="n">settings_file</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">Settings</span><span class="p">()</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">batches</span> <span class="o">=</span> <span class="n">batches</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">inactive</span> <span class="o">=</span> <span class="n">inactive</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">particles</span> <span class="o">=</span> <span class="n">particles</span>

<span class="c1"># Create an initial uniform spatial source distribution over fissionable zones</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">11.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">11.43</span><span class="p">,</span> <span class="mf">11.43</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">uniform_dist</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">bounds</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">:],</span> <span class="n">only_fissionable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">openmc</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">space</span><span class="o">=</span><span class="n">uniform_dist</span><span class="p">)</span>

<span class="c1"># Export to &quot;settings.xml&quot;</span>
<span class="n">settings_file</span><span class="o">.</span><span class="n">export_to_xml</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ONIX-input-part">
<h2>ONIX input part<a class="headerlink" href="#ONIX-input-part" title="Permalink to this headline">¶</a></h2>
<p>This section describes the input commands for ONIX.</p>
<div class="section" id="Defning-a-sequence">
<h3>Defning a sequence<a class="headerlink" href="#Defning-a-sequence" title="Permalink to this headline">¶</a></h3>
<p>The first thing to define is the sequence of burnup points or time points that ONIX should follow when iterating between OpenMC simulations and depletion calculations.</p>
<p>We first define the macrostep vector in burnup units (MWd/kg) or time units (“s” for seconds, “m” for minutes, “d” for days, “y” for years). These points defines when OpenMC simulations update the neutron flux and reaction rates. There is no need to define the initial point (which would be 0 in burnup or time units).</p>
<p>For this simulation, the operation history is made of successive periods of irradtiation cycles and down times. We make use of Python flexibility to create the corresponding Sequence object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cycle5</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mf">295.4</span><span class="p">,</span><span class="mi">310</span><span class="p">]</span>
<span class="n">down5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">332</span><span class="p">]</span>
<span class="n">cycle6</span> <span class="o">=</span> <span class="p">[</span><span class="mf">338.0</span><span class="p">,</span> <span class="mf">362.0</span><span class="p">,</span> <span class="mf">392.0</span><span class="p">,</span> <span class="mf">422.0</span><span class="p">,</span> <span class="mf">452.0</span><span class="p">,</span> <span class="mf">482.0</span><span class="p">,</span> <span class="mf">512.0</span><span class="p">,</span> <span class="mf">542.0</span><span class="p">,</span> <span class="mf">572.0</span><span class="p">,</span> <span class="mf">602.0</span><span class="p">,</span> <span class="mf">632.0</span><span class="p">,</span> <span class="mf">662.0</span><span class="p">,</span> <span class="mf">687.0</span><span class="p">,</span> <span class="mf">718.7</span><span class="p">]</span>
<span class="n">down6</span> <span class="o">=</span> <span class="p">[</span><span class="mf">735.7</span><span class="p">]</span>
<span class="n">cycle7</span> <span class="o">=</span> <span class="p">[</span><span class="mf">741.7</span><span class="p">,</span> <span class="mf">765.7</span><span class="p">,</span> <span class="mf">795.7</span><span class="p">,</span> <span class="mf">825.7</span><span class="p">,</span> <span class="mf">855.7</span><span class="p">,</span> <span class="mf">885.7</span><span class="p">,</span> <span class="mf">915.7</span><span class="p">,</span> <span class="mf">945.7</span><span class="p">,</span> <span class="mf">975.7</span><span class="p">,</span> <span class="mf">1005.7</span><span class="p">,</span> <span class="mf">1044.6</span><span class="p">,</span> <span class="mf">1083.6</span><span class="p">]</span>
<span class="n">down7</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1098.6</span><span class="p">]</span>
<span class="n">cycle8</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1104.6</span><span class="p">,</span> <span class="mf">1128.6</span><span class="p">,</span> <span class="mf">1158.6</span><span class="p">,</span> <span class="mf">1188.6</span><span class="p">,</span> <span class="mf">1218.6</span><span class="p">,</span><span class="mf">1248.6</span><span class="p">,</span> <span class="mf">1278.6</span><span class="p">,</span> <span class="mf">1308.6</span><span class="p">,</span> <span class="mf">1338.6</span><span class="p">,</span> <span class="mf">1368.6</span><span class="p">,</span> <span class="mf">1411.0</span><span class="p">,</span> <span class="mf">1445.4</span><span class="p">]</span>
<span class="n">down8</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">2600</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2601</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2635</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2648</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2672</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2735</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2753</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2760</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2813</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">,</span> <span class="mi">2846</span><span class="o">+</span><span class="mf">1445.4</span><span class="p">]</span>

<span class="n">macrostep_vector</span> <span class="o">=</span> <span class="n">cycle5</span> <span class="o">+</span> <span class="n">down5</span> <span class="o">+</span> <span class="n">cycle6</span> <span class="o">+</span> <span class="n">down6</span> <span class="o">+</span> <span class="n">cycle7</span> <span class="o">+</span> <span class="n">down7</span> <span class="o">+</span> <span class="n">cycle8</span> <span class="o">+</span> <span class="n">down8</span>

<span class="n">macrostep_unit</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
</pre></div>
</div>
</div>
<p>We then define a vector for power of flux normalization. This vector indicates what is the value of the flux or power density to use for each macrostep. The user choose between flux and power density by defining the unit of the vector, “flux” or “power”. The flux should be in units of <span class="math notranslate nohighlight">\(cm^{-2}\cdot s^{-1}\)</span>, the power should be in units of <span class="math notranslate nohighlight">\(kW/l\)</span>.</p>
<p>In this simulation the power density of the assembly decreases cycles after cycles.</p>
<p><strong>Important to note</strong>: the power density is the total power of the system divided by the <strong>total</strong> volume of the system, including non-nuclear elements such as moderator, cladding etc.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">norma_vector_cycle5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">162</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle5</span><span class="p">)</span>
<span class="n">norma_vector_cycle6</span> <span class="o">=</span> <span class="p">[</span><span class="mi">139</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle6</span><span class="p">)</span>
<span class="n">norma_vector_cycle7</span> <span class="o">=</span> <span class="p">[</span><span class="mf">118.8</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle7</span><span class="p">)</span>
<span class="n">norma_vector_cycle8</span> <span class="o">=</span> <span class="p">[</span><span class="mf">33.5</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">cycle8</span><span class="p">)</span>
<span class="n">norma_vector_down8</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">down8</span><span class="p">)</span>

<span class="n">norma_vector</span> <span class="o">=</span> <span class="n">norma_vector_cycle5</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norma_vector_cycle6</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norma_vector_cycle7</span> <span class="o">+</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norma_vector_cycle8</span> <span class="o">+</span> <span class="n">norma_vector_down8</span>
<span class="n">norma_unit</span> <span class="o">=</span> <span class="s1">&#39;power&#39;</span>
</pre></div>
</div>
</div>
<p>The last element of the sequence object that we need to define is the number of microsteps within each macrostep. Below, we indicate to ONIX that there should be 3 microsteps that divide each and every macrosteps.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">microstep_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">macrostep_vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We then instantiate a sequence object and fill it with the vectors we defined above.</p>
<p><strong>Important to note</strong>: since ONIX enables the user to define multiple sequence objects within one input file, the user needs to associate each sequence object with a number id as below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sequence1</span> <span class="o">=</span> <span class="n">onix</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_macrostep</span><span class="p">(</span><span class="n">macrostep_vector</span><span class="p">,</span> <span class="n">macrostep_unit</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_norma</span><span class="p">(</span><span class="n">norma_vector</span><span class="p">,</span> <span class="n">norma_unit</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">microstep_vector</span> <span class="o">=</span> <span class="n">microstep_vector</span>
</pre></div>
</div>
</div>
<p>Finally, we need to define the way ONIX approximate the neutron flux for each microstep. In the current version, the only option is to take the initial value (‘iv’) of the flux for the microstep.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sequence1</span><span class="o">.</span><span class="n">flux_approximation</span> <span class="o">=</span><span class="s1">&#39;iv&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Setting-up-scheduled-parameters-change">
<h3>Setting up scheduled parameters change<a class="headerlink" href="#Setting-up-scheduled-parameters-change" title="Permalink to this headline">¶</a></h3>
<p>ONIX allows the user to schedule change in certain parameters of the operation of the reactor during the simulation such as temperature, density and isotopics of materials.</p>
<p>In this simulation the moderator (water) has its boron concentration manually changed by the operator. In addition, the temperature of both the moderator and the fuel decrease. Because of this decrease in temperature, the density of the water rises.</p>
<p>First we define the isotopic change of the boron isotopes in the water. The change of concentration is expressed in atom fraction because the overall density of the water will also be changed and all individual isotopic concentration will be re-normalized against the new density.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">moderator_B10_online_change</span> <span class="o">=</span> <span class="p">{</span>
<span class="mi">6</span><span class="p">:</span>          <span class="mf">9.736672674935091e-05</span><span class="p">,</span>
<span class="mi">7</span> <span class="p">:</span>         <span class="mf">8.69924941707639e-05</span><span class="p">,</span>
<span class="mi">8</span> <span class="p">:</span>         <span class="mf">7.572967636060627e-05</span><span class="p">,</span>
<span class="mi">9</span> <span class="p">:</span>         <span class="mf">6.477786338149834e-05</span><span class="p">,</span>
<span class="mi">10</span> <span class="p">:</span>        <span class="mf">5.4359201541332796e-05</span><span class="p">,</span>
<span class="mi">11</span> <span class="p">:</span>        <span class="mf">4.45292274170828e-05</span><span class="p">,</span>
<span class="mi">12</span> <span class="p">:</span>        <span class="mf">3.4243853361652844e-05</span><span class="p">,</span>
<span class="mi">13</span> <span class="p">:</span>        <span class="mf">2.298103555149521e-05</span><span class="p">,</span>
<span class="mi">14</span> <span class="p">:</span>        <span class="mf">1.104067150226498e-05</span><span class="p">,</span>
<span class="mi">15</span> <span class="p">:</span>        <span class="mf">1.1107315394632776e-06</span><span class="p">,</span>
<span class="mi">16</span> <span class="p">:</span>        <span class="mf">1.1107315394632776e-06</span><span class="p">,</span>
<span class="mi">18</span> <span class="p">:</span>        <span class="mf">0.0001306109217254868</span><span class="p">,</span>
<span class="mi">19</span> <span class="p">:</span>        <span class="mf">0.0001209475573321563</span><span class="p">,</span>
<span class="mi">20</span> <span class="p">:</span>        <span class="mf">0.00011093986616159216</span><span class="p">,</span>
<span class="mi">21</span> <span class="p">:</span>        <span class="mf">9.983255076695937e-05</span><span class="p">,</span>
<span class="mi">22</span> <span class="p">:</span>        <span class="mf">8.88807377878515e-05</span><span class="p">,</span>
<span class="mi">23</span> <span class="p">:</span>        <span class="mf">7.842875400150202e-05</span><span class="p">,</span>
<span class="mi">24</span> <span class="p">:</span>        <span class="mf">6.856545793106812e-05</span><span class="p">,</span>
<span class="mi">25</span> <span class="p">:</span>        <span class="mf">5.879102038379128e-05</span><span class="p">,</span>
<span class="mi">26</span> <span class="p">:</span>        <span class="mf">4.798360250481359e-05</span><span class="p">,</span>
<span class="mi">27</span> <span class="p">:</span>        <span class="mf">3.59543799324263e-05</span><span class="p">,</span>
<span class="mi">28</span> <span class="p">:</span>        <span class="mf">2.359193789820002e-05</span><span class="p">,</span>
<span class="mi">29</span> <span class="p">:</span>        <span class="mf">1.1307247071736167e-05</span><span class="p">,</span>
<span class="mi">30</span> <span class="p">:</span>        <span class="mf">1.1107315394632774e-06</span><span class="p">,</span>
<span class="mi">31</span> <span class="p">:</span>        <span class="mf">1.1107315394632774e-06</span><span class="p">,</span>
<span class="mi">33</span> <span class="p">:</span>        <span class="mf">0.00011285032440946899</span><span class="p">,</span>
<span class="mi">34</span> <span class="p">:</span>        <span class="mf">0.00010290927713127266</span><span class="p">,</span>
<span class="mi">35</span> <span class="p">:</span>        <span class="mf">9.261279576044808e-05</span><span class="p">,</span>
<span class="mi">36</span> <span class="p">:</span>        <span class="mf">8.13388706348958e-05</span><span class="p">,</span>
<span class="mi">37</span> <span class="p">:</span>        <span class="mf">7.027598450184157e-05</span><span class="p">,</span>
<span class="mi">38</span> <span class="p">:</span>        <span class="mf">5.969071293075653e-05</span><span class="p">,</span>
<span class="mi">39</span> <span class="p">:</span>        <span class="mf">4.970523639098166e-05</span><span class="p">,</span>
<span class="mi">40</span> <span class="p">:</span>        <span class="mf">3.950872085870877e-05</span><span class="p">,</span>
<span class="mi">41</span> <span class="p">:</span>        <span class="mf">2.8323654256313578e-05</span><span class="p">,</span>
<span class="mi">42</span> <span class="p">:</span>        <span class="mf">1.6505470676424304e-05</span><span class="p">,</span>
<span class="mi">43</span> <span class="p">:</span>        <span class="mf">8.663706007813565e-07</span><span class="p">,</span>
<span class="mi">44</span> <span class="p">:</span>        <span class="mf">8.663706007813565e-07</span><span class="p">,</span>
<span class="mi">46</span> <span class="p">:</span>        <span class="mf">0.0001364977988846422</span><span class="p">,</span>
<span class="mi">47</span> <span class="p">:</span>        <span class="mf">0.00012439082510449245</span><span class="p">,</span>
<span class="mi">48</span> <span class="p">:</span>        <span class="mf">0.00011121754904645799</span><span class="p">,</span>
<span class="mi">49</span> <span class="p">:</span>        <span class="mf">9.711125849527437e-05</span><span class="p">,</span>
<span class="mi">50</span> <span class="p">:</span>        <span class="mf">8.321600693658877e-05</span><span class="p">,</span>
<span class="mi">51</span> <span class="p">:</span>        <span class="mf">6.967618947053139e-05</span><span class="p">,</span>
<span class="mi">52</span> <span class="p">:</span>        <span class="mf">5.654734267407547e-05</span><span class="p">,</span>
<span class="mi">53</span> <span class="p">:</span>        <span class="mf">4.3918325070378e-05</span><span class="p">,</span>
<span class="mi">54</span> <span class="p">:</span>        <span class="mf">3.138927330523223e-05</span><span class="p">,</span>
<span class="mi">55</span> <span class="p">:</span>        <span class="mf">1.881579227850792e-05</span><span class="p">,</span>
<span class="mi">56</span> <span class="p">:</span>        <span class="mf">1.3217705319613002e-06</span><span class="p">,</span>
<span class="mi">57</span> <span class="p">:</span>        <span class="mf">1.3217705319613002e-06</span>
<span class="p">}</span>

<span class="n">moderator_B11_online_change</span> <span class="o">=</span> <span class="p">{</span>
<span class="mi">6</span><span class="p">:</span>          <span class="mf">0.00038946690699740366</span><span class="p">,</span>
<span class="mi">7</span> <span class="p">:</span>         <span class="mf">0.0003479699766830556</span><span class="p">,</span>
<span class="mi">8</span> <span class="p">:</span>         <span class="mf">0.00030291870544242507</span><span class="p">,</span>
<span class="mi">9</span> <span class="p">:</span>         <span class="mf">0.00025911145352599336</span><span class="p">,</span>
<span class="mi">10</span> <span class="p">:</span>        <span class="mf">0.00021743680616533118</span><span class="p">,</span>
<span class="mi">11</span> <span class="p">:</span>        <span class="mf">0.0001781169096683312</span><span class="p">,</span>
<span class="mi">12</span> <span class="p">:</span>        <span class="mf">0.00013697541344661137</span><span class="p">,</span>
<span class="mi">13</span> <span class="p">:</span>        <span class="mf">9.192414220598085e-05</span><span class="p">,</span>
<span class="mi">14</span> <span class="p">:</span>        <span class="mf">4.416268600905992e-05</span><span class="p">,</span>
<span class="mi">15</span> <span class="p">:</span>        <span class="mf">4.442926157853111e-06</span><span class="p">,</span>
<span class="mi">16</span> <span class="p">:</span>        <span class="mf">4.442926157853111e-06</span><span class="p">,</span>
<span class="mi">18</span> <span class="p">:</span>        <span class="mf">0.0005224436869019473</span><span class="p">,</span>
<span class="mi">19</span> <span class="p">:</span>        <span class="mf">0.0004837902293286252</span><span class="p">,</span>
<span class="mi">20</span> <span class="p">:</span>        <span class="mf">0.00044375946464636864</span><span class="p">,</span>
<span class="mi">21</span> <span class="p">:</span>        <span class="mf">0.0003993302030678375</span><span class="p">,</span>
<span class="mi">22</span> <span class="p">:</span>        <span class="mf">0.000355522951151406</span><span class="p">,</span>
<span class="mi">23</span> <span class="p">:</span>        <span class="mf">0.0003137150160060081</span><span class="p">,</span>
<span class="mi">24</span> <span class="p">:</span>        <span class="mf">0.0002742618317242725</span><span class="p">,</span>
<span class="mi">25</span> <span class="p">:</span>        <span class="mf">0.00023516408153516512</span><span class="p">,</span>
<span class="mi">26</span> <span class="p">:</span>        <span class="mf">0.00019193441001925436</span><span class="p">,</span>
<span class="mi">27</span> <span class="p">:</span>        <span class="mf">0.0001438175197297052</span><span class="p">,</span>
<span class="mi">28</span> <span class="p">:</span>        <span class="mf">9.436775159280008e-05</span><span class="p">,</span>
<span class="mi">29</span> <span class="p">:</span>        <span class="mf">4.5228988286944666e-05</span><span class="p">,</span>
<span class="mi">30</span> <span class="p">:</span>        <span class="mf">4.44292615785311e-06</span><span class="p">,</span>
<span class="mi">31</span> <span class="p">:</span>        <span class="mf">4.44292615785311e-06</span><span class="p">,</span>
<span class="mi">33</span> <span class="p">:</span>        <span class="mf">0.00045140129763787597</span><span class="p">,</span>
<span class="mi">34</span> <span class="p">:</span>        <span class="mf">0.0004116371085250906</span><span class="p">,</span>
<span class="mi">35</span> <span class="p">:</span>        <span class="mf">0.00037045118304179233</span><span class="p">,</span>
<span class="mi">36</span> <span class="p">:</span>        <span class="mf">0.0003253554825395832</span><span class="p">,</span>
<span class="mi">37</span> <span class="p">:</span>        <span class="mf">0.0002811039380073663</span><span class="p">,</span>
<span class="mi">38</span> <span class="p">:</span>        <span class="mf">0.00023876285172302612</span><span class="p">,</span>
<span class="mi">39</span> <span class="p">:</span>        <span class="mf">0.00019882094556392663</span><span class="p">,</span>
<span class="mi">40</span> <span class="p">:</span>        <span class="mf">0.0001580348834348351</span><span class="p">,</span>
<span class="mi">41</span> <span class="p">:</span>        <span class="mf">0.00011329461702525431</span><span class="p">,</span>
<span class="mi">42</span> <span class="p">:</span>        <span class="mf">6.602188270569722e-05</span><span class="p">,</span>
<span class="mi">43</span> <span class="p">:</span>        <span class="mf">3.465482403125426e-06</span><span class="p">,</span>
<span class="mi">44</span> <span class="p">:</span>        <span class="mf">3.465482403125426e-06</span><span class="p">,</span>
<span class="mi">46</span> <span class="p">:</span>        <span class="mf">0.0005459911955385687</span><span class="p">,</span>
<span class="mi">47</span> <span class="p">:</span>        <span class="mf">0.0004975633004179698</span><span class="p">,</span>
<span class="mi">48</span> <span class="p">:</span>        <span class="mf">0.00044487019618583194</span><span class="p">,</span>
<span class="mi">49</span> <span class="p">:</span>        <span class="mf">0.00038844503398109746</span><span class="p">,</span>
<span class="mi">50</span> <span class="p">:</span>        <span class="mf">0.00033286402774635506</span><span class="p">,</span>
<span class="mi">51</span> <span class="p">:</span>        <span class="mf">0.00027870475788212555</span><span class="p">,</span>
<span class="mi">52</span> <span class="p">:</span>        <span class="mf">0.00022618937069630187</span><span class="p">,</span>
<span class="mi">53</span> <span class="p">:</span>        <span class="mf">0.000175673300281512</span><span class="p">,</span>
<span class="mi">54</span> <span class="p">:</span>        <span class="mf">0.00012555709322092893</span><span class="p">,</span>
<span class="mi">55</span> <span class="p">:</span>        <span class="mf">7.526316911403169e-05</span><span class="p">,</span>
<span class="mi">56</span> <span class="p">:</span>        <span class="mf">5.287082127845201e-06</span><span class="p">,</span>
<span class="mi">57</span> <span class="p">:</span>        <span class="mf">5.287082127845201e-06</span>
<span class="p">}</span>

<span class="n">moderator_isotopic_change</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;B-11&#39;</span><span class="p">:</span> <span class="n">moderator_B11_online_change</span><span class="p">,</span> <span class="s1">&#39;B-10&#39;</span><span class="p">:</span> <span class="n">moderator_B10_online_change</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>Next we define the change in temperature of both the moderator and the fuel and finally the density change in water.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fuel_temperature_change</span> <span class="o">=</span> <span class="p">{</span><span class="mi">17</span><span class="p">:</span> <span class="mf">904.25</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span><span class="mf">819.69</span><span class="p">,</span> <span class="mi">46</span><span class="p">:</span><span class="mf">646.13</span><span class="p">}</span>
<span class="n">moderator_temperature_change</span> <span class="o">=</span> <span class="p">{</span><span class="mi">17</span><span class="p">:</span> <span class="mf">598.98</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span><span class="mf">593.34</span><span class="p">,</span> <span class="mi">46</span><span class="p">:</span><span class="mf">574.23</span><span class="p">}</span>

<span class="n">moderator_density_change</span> <span class="o">=</span> <span class="p">{</span><span class="mi">17</span><span class="p">:</span><span class="mf">0.06670624284397361</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span><span class="mf">0.06831120507781357</span><span class="p">,</span> <span class="mi">46</span><span class="p">:</span><span class="mf">0.07272485122087348</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>Finally, we set these instructions to the Sequence object sequence1. Since the water and the fuel are in multiple geometric regions (as defined in the OpenMC geometry), we need to set the scheduled changes for each of these cells.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sequence1</span><span class="o">.</span><span class="n">set_isotopic_change</span><span class="p">(</span><span class="n">U_moderator_cell</span><span class="p">,</span> <span class="n">moderator_isotopic_change</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;atom fraction&#39;</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_isotopic_change</span><span class="p">(</span><span class="n">GD_moderator_cell</span><span class="p">,</span> <span class="n">moderator_isotopic_change</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;atom fraction&#39;</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_isotopic_change</span><span class="p">(</span><span class="n">Measured_moderator_cell</span><span class="p">,</span> <span class="n">moderator_isotopic_change</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;atom fraction&#39;</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_isotopic_change</span><span class="p">(</span><span class="n">Guide_moderator_in_cell</span><span class="p">,</span> <span class="n">moderator_isotopic_change</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;atom fraction&#39;</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_isotopic_change</span><span class="p">(</span><span class="n">Guide_moderator_out_cell</span><span class="p">,</span> <span class="n">moderator_isotopic_change</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;atom fraction&#39;</span><span class="p">)</span>

<span class="n">sequence1</span><span class="o">.</span><span class="n">set_density_change</span><span class="p">(</span><span class="n">U_moderator_cell</span><span class="p">,</span> <span class="n">moderator_density_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_density_change</span><span class="p">(</span><span class="n">GD_moderator_cell</span><span class="p">,</span> <span class="n">moderator_density_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_density_change</span><span class="p">(</span><span class="n">Measured_moderator_cell</span><span class="p">,</span> <span class="n">moderator_density_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_density_change</span><span class="p">(</span><span class="n">Guide_moderator_in_cell</span><span class="p">,</span> <span class="n">moderator_density_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_density_change</span><span class="p">(</span><span class="n">Guide_moderator_out_cell</span><span class="p">,</span> <span class="n">moderator_density_change</span><span class="p">)</span>

<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">U_cell</span><span class="p">,</span> <span class="n">fuel_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">GD_cell</span><span class="p">,</span> <span class="n">fuel_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">Measured_cell</span><span class="p">,</span> <span class="n">fuel_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">U_moderator_cell</span><span class="p">,</span> <span class="n">moderator_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">GD_moderator_cell</span><span class="p">,</span> <span class="n">moderator_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">Measured_moderator_cell</span><span class="p">,</span> <span class="n">moderator_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">Guide_moderator_in_cell</span><span class="p">,</span> <span class="n">moderator_temperature_change</span><span class="p">)</span>
<span class="n">sequence1</span><span class="o">.</span><span class="n">set_temperature_change</span><span class="p">(</span><span class="n">Guide_moderator_out_cell</span><span class="p">,</span> <span class="n">moderator_temperature_change</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Coupling-with-OpenMC">
<h3>Coupling with OpenMC<a class="headerlink" href="#Coupling-with-OpenMC" title="Permalink to this headline">¶</a></h3>
<p>Once the sequence objects are defined, we can import parameters from OpenMC to construct ONIX depletion systems</p>
<p>We first need to instantiate a couple object. This object will operate all communication between OpenMC and ONIX.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span> <span class="o">=</span> <span class="n">onix</span><span class="o">.</span><span class="n">couple</span><span class="o">.</span><span class="n">Couple_openmc</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>ONIX will run a dummy OpenMC volume simulation. Because this “pre run” simulation calculates volumes, it is necessary to provide a bounding box to ONIX.</p>
<p><strong>Important to note</strong>: ONIX can use the volume provided by this simulation for the burnup regions that the user wants to deplete. However, due to non-negligible errors in the stochastic volume calculation of OpenMC, it is recommended to manually set volumes with the set_vol() command.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">set_bounding_box</span><span class="p">([</span><span class="o">-</span><span class="mf">11.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.43</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">11.43</span><span class="p">,</span> <span class="mf">11.43</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p><strong>[Optional]</strong>: simulations on HPC clusters require to explicitly define the path to the OpenMC executable in the openmc.run() command. The user should indicate the path to OpenMC executable to ONIX with the following command:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">openmc_bin_path</span> <span class="o">=</span> <span class="s1">&#39;/home/julien/virtualenvs/py3/bin/openmc&#39;</span>
</pre></div>
</div>
</div>
<p>The user can select which OpenMC cells will be depleted by adding the names of the cell objects defined above in the command below. Cells that are selected for depletion are called BUCells in ONIX.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">select_bucells</span><span class="p">([</span><span class="n">U_cell</span><span class="p">,</span> <span class="n">GD_cell</span><span class="p">,</span> <span class="n">Measured_cell</span><span class="p">,</span> <span class="n">U_moderator_cell</span><span class="p">,</span><span class="n">GD_moderator_cell</span><span class="p">,</span> <span class="n">Measured_moderator_cell</span><span class="p">,</span> <span class="n">Guide_moderator_in_cell</span><span class="p">,</span> <span class="n">Guide_moderator_out_cell</span> <span class="p">])</span>
</pre></div>
</div>
</div>
<p>The following command indicate to ONIX which OpenMC cell is the root cell. ONIX will use this cell to extract information on OpenMC materials and cells.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">import_openmc</span><span class="p">(</span><span class="n">root_cell</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>[Optional]</strong> By default, ONIX will use ENDF/B-VIII.0 libraries for decay and fission yields data. If users want to use other libraries, they can use the following commands:</p>
<p><strong>Important to note</strong>: if users want to complement the fission yield data library they are defining with the data from ENDF/B-VIII.0, they should set the <em>complete</em> parameter to True in the set_user_fy_lib command.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">set_decay_lib</span><span class="p">(</span><span class="s1">&#39;/home/julien/ONIX/ONIX/onix/data/other_libs/origen2.2/decay_lib&#39;</span><span class="p">)</span>
<span class="n">couple</span><span class="o">.</span><span class="n">set_user_fy_lib</span><span class="p">(</span><span class="s1">&#39;/home/julien/ONIX/ONIX/onix/data/other_libs/origen2.2/fy_lib&#39;</span><span class="p">,</span> <span class="n">complete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>As explained above, OpenMC volume calculations are not always reliable, especially for complex geometry. The user can dedice to manually set volumes for each BUCell.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vol_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U1&#39;</span><span class="p">:</span> <span class="mf">139.9573369652652</span><span class="p">,</span> <span class="s1">&#39;GD1&#39;</span><span class="p">:</span> <span class="mf">5.148932129156914</span><span class="p">,</span> <span class="s1">&#39;cell1&#39;</span><span class="p">:</span> <span class="mf">0.4680847390142649</span><span class="p">,</span> <span class="s1">&#39;cell24&#39;</span><span class="p">:</span> <span class="mf">0.4680847390142649</span><span class="p">,</span> <span class="s1">&#39;total volume&#39;</span><span class="p">:</span><span class="mf">482.342</span><span class="p">}</span>
<span class="n">couple</span><span class="o">.</span><span class="n">set_vol</span><span class="p">(</span><span class="n">vol_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can indicate to the couple object which sequence it should use for the simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">set_sequence</span><span class="p">(</span><span class="n">sequence1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can finally ask ONIX to burn the system and launch the coupled simulation</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">couple</span><span class="o">.</span><span class="n">burn</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Output results are going to be located in two types of folder. Per step folders include densities, power, neutron flux, burnup, one-group cross sections and burnup matrices for each macrostep, separately. The output summary folder contains aggregated output results for the whole simulation and for every macrostep.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="5MWe_reactor_nb.html" class="btn btn-neutral float-right" title="5-MWe - reactor simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pincell_nb.html" class="btn btn-neutral float-left" title="Fuel pin-cell simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Julien de Troullioud de Lanversin

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</body>
</html>